import{g as q,R as H,r as T,j as m}from"./app-Bu3c7SRr.js";import{_ as $}from"./extends-CF3RwP-h.js";import{D as Y,b as X,c as J,d as G,e as K}from"./dialog-ggMMgphc.js";import{T as Q,a as Z,b as L,c as z}from"./tabs-B7qZ_r0x.js";import{B as E}from"./button-Bugdv60n.js";import"./index-ChGmrCfR.js";import"./createLucideIcon-Bz1iimCp.js";import"./index-SS-33b3l.js";import"./index-DFqYG-k0.js";import"./index-BUVUn23p.js";import"./index-_W5zKMP9.js";import"./index-C7O5j1LF.js";import"./index-DwKaao6N.js";import"./utils-CytzSlOG.js";import"./index-BwobEAja.js";function tt(e,r){if(e==null)return{};var n={};for(var t in e)if({}.hasOwnProperty.call(e,t)){if(r.includes(t))continue;n[t]=e[t]}return n}function et(e,r){if(e==null)return{};var n,t,o=tt(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)n=a[t],r.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function W(e){"@babel/helpers - typeof";return W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},W(e)}function rt(e,r,n){return Object.defineProperty(e,"prototype",{writable:!1}),e}function nt(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function k(e,r){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,t){return n.__proto__=t,n},k(e,r)}function ot(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&k(e,r)}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},R(e)}function I(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(I=function(){return!!e})()}function it(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function at(e,r){if(r&&(W(r)=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return it(e)}function st(e){var r=I();return function(){var n,t=R(e);if(r){var o=R(this).constructor;n=Reflect.construct(t,arguments,o)}else n=t.apply(this,arguments);return at(this,n)}}var O={exports:{}},j,U;function ct(){if(U)return j;U=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return j=e,j}var M,B;function ut(){if(B)return M;B=1;var e=ct();function r(){}function n(){}return n.resetWarningCache=r,M=function(){function t(u,i,s,c,h,d){if(d!==e){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}t.isRequired=t;function o(){return t}var a={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:o,element:t,elementType:t,instanceOf:o,node:t,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:n,resetWarningCache:r};return a.PropTypes=a,a},M}var F;function lt(){return F||(F=1,O.exports=ut()()),O.exports}var ht=lt();const x=q(ht);/*!
 * Signature Pad v2.3.2
 * https://github.com/szimek/signature_pad
 *
 * Copyright 2017 Szymon Nowak
 * Released under the MIT license
 *
 * The main idea and some parts of the code (e.g. drawing variable width Bézier curve) are taken from:
 * http://corner.squareup.com/2012/07/smoother-signatures.html
 *
 * Implementation of interpolation using cubic Bézier curves is taken from:
 * http://benknowscode.wordpress.com/2012/09/14/path-interpolation-using-cubic-bezier-and-control-point-estimation-in-javascript
 *
 * Algorithm for approximated length of a Bézier curve is taken from:
 * http://www.lemoda.net/maths/bezier-length/index.html
 *
 */function C(e,r,n){this.x=e,this.y=r,this.time=n||new Date().getTime()}C.prototype.velocityFrom=function(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):1};C.prototype.distanceTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))};C.prototype.equals=function(e){return this.x===e.x&&this.y===e.y&&this.time===e.time};function N(e,r,n,t){this.startPoint=e,this.control1=r,this.control2=n,this.endPoint=t}N.prototype.length=function(){for(var e=10,r=0,n=void 0,t=void 0,o=0;o<=e;o+=1){var a=o/e,u=this._point(a,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),i=this._point(a,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(o>0){var s=u-n,c=i-t;r+=Math.sqrt(s*s+c*c)}n=u,t=i}return r};N.prototype._point=function(e,r,n,t,o){return r*(1-e)*(1-e)*(1-e)+3*n*(1-e)*(1-e)*e+3*t*(1-e)*e*e+o*e*e*e};function dt(e,r,n){var t,o,a,u=null,i=0;n||(n={});var s=function(){i=n.leading===!1?0:Date.now(),u=null,a=e.apply(t,o),u||(t=o=null)};return function(){var c=Date.now();!i&&n.leading===!1&&(i=c);var h=r-(c-i);return t=this,o=arguments,h<=0||h>r?(u&&(clearTimeout(u),u=null),i=c,a=e.apply(t,o),u||(t=o=null)):!u&&n.trailing!==!1&&(u=setTimeout(s,h)),a}}function f(e,r){var n=this,t=r||{};this.velocityFilterWeight=t.velocityFilterWeight||.7,this.minWidth=t.minWidth||.5,this.maxWidth=t.maxWidth||2.5,this.throttle="throttle"in t?t.throttle:16,this.minDistance="minDistance"in t?t.minDistance:5,this.throttle?this._strokeMoveUpdate=dt(f.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=f.prototype._strokeUpdate,this.dotSize=t.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=t.penColor||"black",this.backgroundColor=t.backgroundColor||"rgba(0,0,0,0)",this.onBegin=t.onBegin,this.onEnd=t.onEnd,this._canvas=e,this._ctx=e.getContext("2d"),this.clear(),this._handleMouseDown=function(o){o.which===1&&(n._mouseButtonDown=!0,n._strokeBegin(o))},this._handleMouseMove=function(o){n._mouseButtonDown&&n._strokeMoveUpdate(o)},this._handleMouseUp=function(o){o.which===1&&n._mouseButtonDown&&(n._mouseButtonDown=!1,n._strokeEnd(o))},this._handleTouchStart=function(o){if(o.targetTouches.length===1){var a=o.changedTouches[0];n._strokeBegin(a)}},this._handleTouchMove=function(o){o.preventDefault();var a=o.targetTouches[0];n._strokeMoveUpdate(a)},this._handleTouchEnd=function(o){var a=o.target===n._canvas;a&&(o.preventDefault(),n._strokeEnd(o))},this.on()}f.prototype.clear=function(){var e=this._ctx,r=this._canvas;e.fillStyle=this.backgroundColor,e.clearRect(0,0,r.width,r.height),e.fillRect(0,0,r.width,r.height),this._data=[],this._reset(),this._isEmpty=!0};f.prototype.fromDataURL=function(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=new Image,o=n.ratio||window.devicePixelRatio||1,a=n.width||this._canvas.width/o,u=n.height||this._canvas.height/o;this._reset(),t.src=e,t.onload=function(){r._ctx.drawImage(t,0,0,a,u)},this._isEmpty=!1};f.prototype.toDataURL=function(e){var r;switch(e){case"image/svg+xml":return this._toSVG();default:for(var n=arguments.length,t=Array(n>1?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];return(r=this._canvas).toDataURL.apply(r,[e].concat(t))}};f.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()};f.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)};f.prototype.isEmpty=function(){return this._isEmpty};f.prototype._strokeBegin=function(e){this._data.push([]),this._reset(),this._strokeUpdate(e),typeof this.onBegin=="function"&&this.onBegin(e)};f.prototype._strokeUpdate=function(e){var r=e.clientX,n=e.clientY,t=this._createPoint(r,n),o=this._data[this._data.length-1],a=o&&o[o.length-1],u=a&&t.distanceTo(a)<this.minDistance;if(!(a&&u)){var i=this._addPoint(t),s=i.curve,c=i.widths;s&&c&&this._drawCurve(s,c.start,c.end),this._data[this._data.length-1].push({x:t.x,y:t.y,time:t.time,color:this.penColor})}};f.prototype._strokeEnd=function(e){var r=this.points.length>2,n=this.points[0];if(!r&&n&&this._drawDot(n),n){var t=this._data[this._data.length-1],o=t[t.length-1];n.equals(o)||t.push({x:n.x,y:n.y,time:n.time,color:this.penColor})}typeof this.onEnd=="function"&&this.onEnd(e)};f.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)};f.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)};f.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor};f.prototype._createPoint=function(e,r,n){var t=this._canvas.getBoundingClientRect();return new C(e-t.left,r-t.top,n||new Date().getTime())};f.prototype._addPoint=function(e){var r=this.points,n=void 0;if(r.push(e),r.length>2){r.length===3&&r.unshift(r[0]),n=this._calculateCurveControlPoints(r[0],r[1],r[2]);var t=n.c2;n=this._calculateCurveControlPoints(r[1],r[2],r[3]);var o=n.c1,a=new N(r[1],t,o,r[2]),u=this._calculateCurveWidths(a);return r.shift(),{curve:a,widths:u}}return{}};f.prototype._calculateCurveControlPoints=function(e,r,n){var t=e.x-r.x,o=e.y-r.y,a=r.x-n.x,u=r.y-n.y,i={x:(e.x+r.x)/2,y:(e.y+r.y)/2},s={x:(r.x+n.x)/2,y:(r.y+n.y)/2},c=Math.sqrt(t*t+o*o),h=Math.sqrt(a*a+u*u),d=i.x-s.x,l=i.y-s.y,p=h/(c+h),v={x:s.x+d*p,y:s.y+l*p},g=r.x-v.x,_=r.y-v.y;return{c1:new C(i.x+g,i.y+_),c2:new C(s.x+g,s.y+_)}};f.prototype._calculateCurveWidths=function(e){var r=e.startPoint,n=e.endPoint,t={start:null,end:null},o=this.velocityFilterWeight*n.velocityFrom(r)+(1-this.velocityFilterWeight)*this._lastVelocity,a=this._strokeWidth(o);return t.start=this._lastWidth,t.end=a,this._lastVelocity=o,this._lastWidth=a,t};f.prototype._strokeWidth=function(e){return Math.max(this.maxWidth/(e+1),this.minWidth)};f.prototype._drawPoint=function(e,r,n){var t=this._ctx;t.moveTo(e,r),t.arc(e,r,n,0,2*Math.PI,!1),this._isEmpty=!1};f.prototype._drawCurve=function(e,r,n){var t=this._ctx,o=n-r,a=Math.floor(e.length());t.beginPath();for(var u=0;u<a;u+=1){var i=u/a,s=i*i,c=s*i,h=1-i,d=h*h,l=d*h,p=l*e.startPoint.x;p+=3*d*i*e.control1.x,p+=3*h*s*e.control2.x,p+=c*e.endPoint.x;var v=l*e.startPoint.y;v+=3*d*i*e.control1.y,v+=3*h*s*e.control2.y,v+=c*e.endPoint.y;var g=r+c*o;this._drawPoint(p,v,g)}t.closePath(),t.fill()};f.prototype._drawDot=function(e){var r=this._ctx,n=typeof this.dotSize=="function"?this.dotSize():this.dotSize;r.beginPath(),this._drawPoint(e.x,e.y,n),r.closePath(),r.fill()};f.prototype._fromData=function(e,r,n){for(var t=0;t<e.length;t+=1){var o=e[t];if(o.length>1)for(var a=0;a<o.length;a+=1){var u=o[a],i=new C(u.x,u.y,u.time),s=u.color;if(a===0)this.penColor=s,this._reset(),this._addPoint(i);else if(a!==o.length-1){var c=this._addPoint(i),h=c.curve,d=c.widths;h&&d&&r(h,d,s)}}else{this._reset();var l=o[0];n(l)}}};f.prototype._toSVG=function(){var e=this,r=this._data,n=this._canvas,t=Math.max(window.devicePixelRatio||1,1),o=0,a=0,u=n.width/t,i=n.height/t,s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttributeNS(null,"width",n.width),s.setAttributeNS(null,"height",n.height),this._fromData(r,function(y,w,P){var b=document.createElement("path");if(!isNaN(y.control1.x)&&!isNaN(y.control1.y)&&!isNaN(y.control2.x)&&!isNaN(y.control2.y)){var V="M "+y.startPoint.x.toFixed(3)+","+y.startPoint.y.toFixed(3)+" "+("C "+y.control1.x.toFixed(3)+","+y.control1.y.toFixed(3)+" ")+(y.control2.x.toFixed(3)+","+y.control2.y.toFixed(3)+" ")+(y.endPoint.x.toFixed(3)+","+y.endPoint.y.toFixed(3));b.setAttribute("d",V),b.setAttribute("stroke-width",(w.end*2.25).toFixed(3)),b.setAttribute("stroke",P),b.setAttribute("fill","none"),b.setAttribute("stroke-linecap","round"),s.appendChild(b)}},function(y){var w=document.createElement("circle"),P=typeof e.dotSize=="function"?e.dotSize():e.dotSize;w.setAttribute("r",P),w.setAttribute("cx",y.x),w.setAttribute("cy",y.y),w.setAttribute("fill",y.color),s.appendChild(w)});var c="data:image/svg+xml;base64,",h='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="'+o+" "+a+" "+u+" "+i+'"')+(' width="'+u+'"')+(' height="'+i+'"')+">",d=s.innerHTML;if(d===void 0){var l=document.createElement("dummy"),p=s.childNodes;l.innerHTML="";for(var v=0;v<p.length;v+=1)l.appendChild(p[v].cloneNode(!0));d=l.innerHTML}var g="</svg>",_=h+d+g;return c+btoa(_)};f.prototype.fromData=function(e){var r=this;this.clear(),this._fromData(e,function(n,t){return r._drawCurve(n,t.start,t.end)},function(n){return r._drawDot(n)}),this._data=e};f.prototype.toData=function(){return this._data};var D={exports:{}},pt=D.exports,A;function ft(){return A||(A=1,function(e,r){(function(n,t){e.exports=t()})(pt,function(){return function(n){function t(a){if(o[a])return o[a].exports;var u=o[a]={exports:{},id:a,loaded:!1};return n[a].call(u.exports,u,u.exports,t),u.loaded=!0,u.exports}var o={};return t.m=n,t.c=o,t.p="",t(0)}([function(n,t){function o(c){var h=c.getContext("2d"),d=c.width,l=c.height,p=h.getImageData(0,0,d,l).data,v=i(!0,d,l,p),g=i(!1,d,l,p),_=s(!0,d,l,p),y=s(!1,d,l,p),w=y-_+1,P=g-v+1,b=h.getImageData(_,v,w,P);return c.width=w,c.height=P,h.clearRect(0,0,w,P),h.putImageData(b,0,0),c}function a(c,h,d,l){return{red:l[4*(d*h+c)],green:l[4*(d*h+c)+1],blue:l[4*(d*h+c)+2],alpha:l[4*(d*h+c)+3]}}function u(c,h,d,l){return a(c,h,d,l).alpha}function i(c,h,d,l){for(var p=c?1:-1,v=c?0:d-1,g=v;c?g<d:g>-1;g+=p)for(var _=0;_<h;_++)if(u(_,g,h,l))return g;return null}function s(c,h,d,l){for(var p=c?1:-1,v=c?0:h-1,g=v;c?g<h:g>-1;g+=p)for(var _=0;_<d;_++)if(u(g,_,h,l))return g;return null}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o}])})}(D)),D.exports}var vt=ft();const mt=q(vt);var gt=["canvasProps","clearOnResize"],S=function(e){ot(n,e);var r=st(n);function n(){var t;nt(this,n);for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return t=r.call.apply(r,[this].concat(a)),t.staticThis=t.constructor,t._sigPad=null,t._canvas=null,t.setRef=function(i){t._canvas=i,t._canvas===null&&(t._sigPad=null)},t._excludeOurProps=function(){var i=t.props;i.canvasProps,i.clearOnResize;var s=et(i,gt);return s},t.componentDidMount=function(){var i=t.getCanvas();t._sigPad=new f(i,t._excludeOurProps()),t._resizeCanvas(),t.on()},t.componentWillUnmount=function(){t.off()},t.componentDidUpdate=function(){Object.assign(t._sigPad,t._excludeOurProps())},t.getCanvas=function(){if(t._canvas===null)throw t.staticThis.refNullError;return t._canvas},t.getTrimmedCanvas=function(){var i=t.getCanvas(),s=document.createElement("canvas");return s.width=i.width,s.height=i.height,s.getContext("2d").drawImage(i,0,0),mt(s)},t.getSignaturePad=function(){if(t._sigPad===null)throw t.staticThis.refNullError;return t._sigPad},t._checkClearOnResize=function(){t.props.clearOnResize&&t._resizeCanvas()},t._resizeCanvas=function(){var i,s,c=(i=t.props.canvasProps)!==null&&i!==void 0?i:{},h=c.width,d=c.height;if(!(typeof h<"u"&&typeof d<"u")){var l=t.getCanvas(),p=Math.max((s=window.devicePixelRatio)!==null&&s!==void 0?s:1,1);typeof h>"u"&&(l.width=l.offsetWidth*p),typeof d>"u"&&(l.height=l.offsetHeight*p),l.getContext("2d").scale(p,p),t.clear()}},t.render=function(){var i=t.props.canvasProps;return H.createElement("canvas",$({ref:t.setRef},i))},t.on=function(){return window.addEventListener("resize",t._checkClearOnResize),t.getSignaturePad().on()},t.off=function(){return window.removeEventListener("resize",t._checkClearOnResize),t.getSignaturePad().off()},t.clear=function(){return t.getSignaturePad().clear()},t.isEmpty=function(){return t.getSignaturePad().isEmpty()},t.fromDataURL=function(i,s){return t.getSignaturePad().fromDataURL(i,s)},t.toDataURL=function(i,s){return t.getSignaturePad().toDataURL(i,s)},t.fromData=function(i){return t.getSignaturePad().fromData(i)},t.toData=function(){return t.getSignaturePad().toData()},t}return rt(n)}(T.Component);S.propTypes={velocityFilterWeight:x.number,minWidth:x.number,maxWidth:x.number,minDistance:x.number,dotSize:x.oneOfType([x.number,x.func]),penColor:x.string,throttle:x.number,onEnd:x.func,onBegin:x.func,canvasProps:x.object,clearOnResize:x.bool};S.defaultProps={clearOnResize:!0};S.refNullError=new Error("react-signature-canvas is currently mounting or unmounting: React refs are null during this phase.");function Wt({isOpen:e,onClose:r,onComplete:n}){const[t,o]=T.useState("customer"),[a,u]=T.useState(null),i=T.useRef(null),s=T.useRef(null),c=()=>{var p,v;if((p=i.current)!=null&&p.isEmpty()){alert("Please provide a signature");return}const l=(v=i.current)==null?void 0:v.getCanvas();l&&(u(l.toDataURL()),o("driver"))},h=()=>{var p,v;if((p=s.current)!=null&&p.isEmpty()){alert("Please provide a signature");return}if(!a){alert("Customer signature is required");return}const l=(v=s.current)==null?void 0:v.getCanvas();l&&n(a,l.toDataURL())},d=l=>{var p;(p=l.current)==null||p.clear()};return m.jsx(Y,{open:e,onOpenChange:r,children:m.jsxs(X,{className:"max-w-3xl",children:[m.jsxs(J,{children:[m.jsx(G,{children:"Collection Signatures"}),m.jsx(K,{children:"Please collect signatures from both the customer and driver to mark this job as collected."})]}),m.jsxs(Q,{value:t,onValueChange:o,children:[m.jsxs(Z,{className:"grid w-full grid-cols-2",children:[m.jsx(L,{value:"customer",children:"Customer"}),m.jsx(L,{value:"driver",disabled:!a,children:"Driver"})]}),m.jsx(z,{value:"customer",children:m.jsxs("div",{className:"space-y-4",children:[m.jsx("div",{className:"border rounded-lg p-4",children:m.jsx(S,{ref:i,canvasProps:{className:"signature-canvas w-full h-[200px] border rounded-lg bg-white",style:{touchAction:"none"}}})}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx(E,{variant:"outline",onClick:()=>d(i),children:"Clear"}),m.jsx(E,{onClick:c,children:"I Agree"})]})]})}),m.jsx(z,{value:"driver",children:m.jsxs("div",{className:"space-y-4",children:[m.jsx("div",{className:"border rounded-lg p-4",children:m.jsx(S,{ref:s,canvasProps:{className:"signature-canvas w-full h-[200px] border rounded-lg bg-white",style:{touchAction:"none"}}})}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx(E,{variant:"outline",onClick:()=>d(s),children:"Clear"}),m.jsx(E,{onClick:h,children:"Mark Job Collected"})]})]})})]})]})})}export{Wt as default};
