import{r as f,j as e,h as L,b as $}from"./app-BB65Mc1n.js";import{S as H,A as z,a as G,b as K,B as U,c as W,d as b,e as N,f as P}from"./breadcrumb-D6RxqHid.js";import{S as x}from"./separator-BWJbAkR8.js";import{B as y}from"./button-AMd0rht4.js";import{I as r}from"./input-BdsrUm4j.js";import{L as n}from"./label-B29Fbpt8.js";import{S as g,a as p,b as j,c as u,d as o}from"./select-Dp5Udnaz.js";import{t as v}from"./index-BD8g9cTJ.js";import{A as X,a as Y,b as Z,c as ee,d as se,e as ie,f as ne,g as ae,h as le}from"./alert-dialog-BkxvyqSV.js";import{A as ce}from"./arrow-left-Dk30N2JD.js";import{S as de}from"./save-DRu4wydO.js";import{T as te}from"./trash-2-CyBVRyGm.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./dialog-44kL--cs.js";import"./index-DJRbUwlk.js";import"./index-CwOflKzf.js";import"./index-Bax49BpN.js";import"./index-C6WAMNeG.js";import"./index-BD0Aflgb.js";import"./index-DwCxHBl2.js";import"./createLucideIcon-DhOTYlCm.js";import"./index-d89-VRCp.js";import"./index-C6DuYNlM.js";import"./index--1ygw0mz.js";import"./index-D9Y9XxbS.js";import"./calendar-C06wmWHl.js";import"./index-DbDOfuCE.js";function Me({job:a,customers:S,addresses:w,collection_types:T,sanitisation_options:B,status_options:I,staff_members:re,sub_clients:C}){var D,k,q,E;const[V,A]=f.useState(!1),M=()=>{A(!0),L.delete(`/quotes/${a.id}`,{onSuccess:()=>{v.success("Job successfully deleted!"),L.get("/quotes")},onError:()=>{v.error("Failed to delete job. Please try again."),A(!1)}})},[l,h]=f.useState({job_id:a.job_id||"",client_id:((D=a.client_id)==null?void 0:D.toString())||"",collection_date:a.collection_date?new Date(a.collection_date).toISOString().split("T")[0]:"",job_status:a.job_status||"",staff_collecting:a.staff_collecting||"",vehicle:a.vehicle||"",driver_carrier_registration:a.driver_carrier_registration||"",address:a.address||"",address_2:a.address_2||"",town_city:a.town_city||"",postcode:a.postcode||"",onsite_contact:a.onsite_contact||"",onsite_number:a.onsite_number||"",onsite_email:a.onsite_email||"",collection_type:((k=a.collection_type)==null?void 0:k.toString())||"",data_sanitisation:a.data_sanitisation||"",sla:a.sla||"",instructions:a.instructions||"",equipment_location:a.equipment_location||"",building_access:a.building_access||"",collection_route:a.collection_route||"",parking_loading:a.parking_loading||"",equipment_readiness:a.equipment_readiness||"",driver_type:a.driver_type||""}),[O,F]=f.useState(!1),t=i=>{const{name:d,value:c}=i.target;h(m=>({...m,[d]:c}))},_=(i,d)=>{h(c=>({...c,[i]:d}))},J=i=>{if(i==="manual"){h(c=>({...c,address:"",address_2:"",town_city:"",county:"",postcode:""}));return}if(i==="main"){s&&h(c=>({...c,address:s.address||"",address_2:s.address_2||"",town_city:s.town_city||"",county:s.county||"",postcode:s.postcode||""}));return}const d=w.find(c=>c.id.toString()===i);d&&h(c=>({...c,address:d.address,address_2:d.address_2,town_city:d.town_city,county:d.county||"",postcode:d.postcode}))},Q=i=>{if(i==="manual"){h(c=>({...c,onsite_contact:"",onsite_number:"",onsite_email:""}));return}if(i==="main"&&s){h(c=>({...c,onsite_contact:s.contact_name||"",onsite_number:s.mobile||s.landline||"",onsite_email:s.email||""}));return}const d=C.find(c=>c.id.toString()===i);d&&h(c=>({...c,onsite_contact:d.name,onsite_number:d.mobile||d.landline||"",onsite_email:d.email}))},R=async()=>{var i,d,c;try{F(!0);const m={...l,collection_type:l.collection_type?parseInt(l.collection_type):null};console.log("Saving data:",m),(await $.put(`/quotes/${a.id}`,m)).status===200?v.success("Changes saved successfully!"):v.error("Failed to save changes. Please try again.")}catch(m){console.error("Save error:",((i=m.response)==null?void 0:i.data)||m),v.error(((c=(d=m.response)==null?void 0:d.data)==null?void 0:c.message)||"An error occurred while saving changes.")}finally{F(!1)}},s=S.find(i=>i.id.toString()===l.client_id);return e.jsxs(H,{children:[e.jsx(z,{}),e.jsxs(G,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 bg-white border-b",children:[e.jsx(K,{className:"-ml-1"}),e.jsx(x,{orientation:"vertical",className:"h-4 mx-2"}),e.jsx(U,{children:e.jsxs(W,{children:[e.jsx(b,{children:e.jsx(N,{href:"/dashboard",children:"Dashboard"})}),e.jsx(P,{}),e.jsx(b,{children:e.jsx(N,{href:"/quotes",children:"Quotes"})}),e.jsx(P,{}),e.jsx(b,{children:e.jsx(N,{href:"#",children:"Edit Quote"})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-3xl font-semibold text-gray-800",children:["Quote: ",a.job_id]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(y,{variant:"outline",onClick:()=>window.location.href=`/quotes/${a.id}`,children:[e.jsx(ce,{className:"h-6 w-6"}),"Done Editing"]}),e.jsxs(y,{className:"bg-green-500 text-white hover:bg-green-600 focus:ring-2 focus:ring-green-400",onClick:R,disabled:O,children:[e.jsx(de,{className:"h-6 w-6"}),"Save Changes"]}),e.jsxs(X,{children:[e.jsx(Y,{asChild:!0,children:e.jsxs(y,{className:"bg-red-500 text-white hover:bg-red-600 focus:ring-2 focus:ring-red-400",disabled:V,children:[e.jsx(te,{className:"h-6 w-6"}),"Delete Job"]})}),e.jsxs(Z,{children:[e.jsxs(ee,{children:[e.jsx(se,{children:"Confirm Deletion"}),e.jsx(ie,{children:"Are you sure you want to delete this job? This action cannot be undone."})]}),e.jsxs(ne,{children:[e.jsx(ae,{children:"Cancel"}),e.jsx(le,{onClick:M,children:"Delete"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("section",{className:"bg-white border shadow rounded-lg",children:[e.jsx("header",{className:"p-6",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Collection Details"})}),e.jsx(x,{}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"job_id",children:"Job Number*"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"job_id",name:"job_id",value:l.job_id,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"client_id",children:"Customer*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{value:l.client_id,onValueChange:i=>_("client_id",i),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Select Customer"})}),e.jsx(u,{children:S.map(i=>e.jsx(o,{value:i.id.toString(),children:i.company_name||i.name},i.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"job_status",children:"Status*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{value:l.job_status,onValueChange:i=>_("job_status",i),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Select Status"})}),e.jsx(u,{children:I.map(i=>e.jsx(o,{value:i,children:i},i))})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"collection_date",children:"Collection Date"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"collection_date",name:"collection_date",type:"date",value:l.collection_date,onChange:t})})]})]}),e.jsx(x,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"collection_address",children:"Collection Address"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{onValueChange:J,children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Enter Manually"})}),e.jsxs(u,{children:[e.jsx(o,{value:"manual",children:"Enter Manually"}),s&&s.address&&e.jsxs(o,{value:"main",children:[s.address,", ",s.address_2,", ",s.town_city,", ",s.postcode," (Account Address)"]}),w.map(i=>e.jsxs(o,{value:i.id.toString(),children:[i.address,", ",i.address_2,", ",i.town_city,", ",i.postcode]},i.id))]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"address",children:"Address Line 1"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"address",name:"address",value:l.address,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"address_2",children:"Address Line 2"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"address_2",name:"address_2",value:l.address_2,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"town_city",children:"Town/City"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"town_city",name:"town_city",value:l.town_city,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"county",children:"County"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"county",name:"county",value:l.county||"",onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"postcode",children:"Postcode"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"postcode",name:"postcode",value:l.postcode,onChange:t})})]})]}),e.jsx(x,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"onsite_contact_select",children:"Onsite Contact"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{onValueChange:Q,children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Enter Manually"})}),e.jsxs(u,{children:[e.jsx(o,{value:"manual",children:"Enter Manually"}),s&&s.contact_name&&e.jsxs(o,{value:"main",children:[s.contact_name," (Main Contact)"]}),C.map(i=>e.jsx(o,{value:i.id.toString(),children:i.name},i.id))]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"onsite_contact",children:"Onsite Contact Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"onsite_contact",name:"onsite_contact",value:l.onsite_contact,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"onsite_number",children:"Onsite Contact Number"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"onsite_number",name:"onsite_number",value:l.onsite_number,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"onsite_email",children:"Onsite Contact Email"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"onsite_email",name:"onsite_email",type:"email",value:l.onsite_email,onChange:t})})]}),e.jsx(x,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"collection_type",children:"Collection Type*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{value:((q=l.collection_type)==null?void 0:q.toString())||"",onValueChange:i=>_("collection_type",i),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Select Collection Type"})}),e.jsx(u,{children:T.map(i=>e.jsx(o,{value:i.id.toString(),children:i.colt_name},i.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"data_sanitisation",children:"Data Sanitisation*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{value:((E=l.data_sanitisation)==null?void 0:E.toString())||"",onValueChange:i=>_("data_sanitisation",i),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Select Data Sanitisation"})}),e.jsx(u,{children:B.map(i=>e.jsx(o,{value:i.id.toString(),children:i.ds_name},i.id))})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"sla",children:"Service Level Agreement"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"sla",name:"sla",value:l.sla,onChange:t})})]})]})]})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg self-start",children:[e.jsxs("div",{className:"flex items-center justify-between p-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Customer Details"}),e.jsxs("div",{className:"text-sm",children:["Account Status: ",e.jsx("span",{className:"text-green-500",children:"Active"})]})]}),e.jsx("hr",{className:"my-0"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Company Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.company_name)||(s==null?void 0:s.name)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Address Line 1"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.address)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Address Line 2"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.address_2)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Town/City"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.town_city)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"County"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.county)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Postcode"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.postcode)||"-"})})]})]}),e.jsx(x,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Contact Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.contact_name)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Position"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.position)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Landline"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.landline)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Mobile"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.mobile)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Email"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.email)||"-"})})]}),e.jsx(x,{}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"equipment_location",children:"Equipment Location"}),e.jsx("textarea",{id:"equipment_location",name:"equipment_location",rows:4,placeholder:"Please enter any notes about Equipment Location here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:l.equipment_location,onChange:t})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"building_access",children:"Building Access"}),e.jsx("textarea",{id:"building_access",name:"building_access",rows:4,placeholder:"Please enter any notes about Building Access here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:l.building_access,onChange:t})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"collection_route",children:"Collection Route"}),e.jsx("textarea",{id:"collection_route",name:"collection_route",rows:4,placeholder:"Please enter any notes about this job here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:l.collection_route,onChange:t})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"collection_route",children:"Parking & Loading"}),e.jsx("textarea",{id:"parking_loading",name:"parking_loading",rows:4,placeholder:"Please enter any notes about Parking & Loading here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:l.parking_loading,onChange:t})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"equipment_readiness",children:"Equipment Readiness"}),e.jsx("textarea",{id:"equipment_readiness",name:"equipment_readiness",rows:4,placeholder:"Please enter any notes about Equipment Readiness here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:l.equipment_readiness,onChange:t})]}),e.jsx(x,{}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"collection_route",children:"Other Information"}),e.jsx("textarea",{id:"instructions",name:"instructions",rows:4,placeholder:"Please enter any notes about this job here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:l.instructions,onChange:t})]})]})]})]})]})]})]})]})}export{Me as default};
