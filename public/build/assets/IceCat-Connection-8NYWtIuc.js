import{r,j as e,b as d}from"./app-CxxjQbGd.js";import{t as o}from"./index-CGbDflUn.js";import{B as p}from"./button-BfCUFj2v.js";import{I as f}from"./input-DPP4pqCX.js";import{B as v}from"./badge-BZbc9Efx.js";import"./index-DdQz_MXT.js";import"./index-B6zYnIfL.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";function D(){const[s,l]=r.useState({apiKey:"",username:""}),[n,i]=r.useState(!1),[u,y]=r.useState(!0),[a,c]=r.useState(!1);r.useEffect(()=>{(async()=>{try{const m=await d.get("/settings/connections/icecat");m.data.connected?(i(!0),l({apiKey:m.data.apiKey,username:m.data.username})):i(!1)}catch{i(!1)}finally{y(!1)}})()},[]);const h=async()=>{c(!0);try{(await d.post("/settings/connections/icecat/test",{apiKey:s.apiKey,username:s.username})).status===200&&o.success("IceCat connection is working!")}catch{o.error("Failed to test IceCat connection. Please check the credentials and try again.")}finally{c(!1)}},x=async()=>{c(!0);try{(await d.post("/settings/connections/icecat/save",{apiKey:s.apiKey,username:s.username})).status===200&&(i(!0),o.success("IceCat connection saved successfully!"))}catch{o.error("Failed to save IceCat connection. Please ensure the credentials are valid and try again.")}finally{c(!1)}},g=async()=>{c(!0);try{(await d.delete("/settings/connections/icecat")).status===200&&(i(!1),l({apiKey:"",username:""}),o.success("Disconnected from IceCat."))}catch{o.error("Failed to disconnect from IceCat.")}finally{c(!1)}},C=u?"success":n?"default":"success";return e.jsxs("div",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"IceCat API"}),e.jsx(v,{variant:C,children:u?"Loading...":n?"Connected":"Not Connected"})]}),!u&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n?"Your IceCat API connection is active.":"Enter your IceCat credentials to connect."}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(f,{type:"text",placeholder:"API Key",value:s.apiKey,onChange:t=>l({...s,apiKey:t.target.value}),disabled:a||n}),e.jsx(f,{type:"text",placeholder:"Username",value:s.username,onChange:t=>l({...s,username:t.target.value}),disabled:a||n}),e.jsxs("div",{className:"flex gap-4",children:[!n&&e.jsx(p,{onClick:x,disabled:a,children:a?"Saving...":"Connect"}),n&&e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"outline",onClick:h,disabled:a,children:"Test Connection"}),e.jsx(p,{variant:"destructive",onClick:g,disabled:a,children:"Disconnect"})]})]})]})]})]})}export{D as default};
