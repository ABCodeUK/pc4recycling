import{j as e,r as g,b as f}from"./app-CxxjQbGd.js";import{S as X,A as Y,a as Z,b as ee,B as se,c as re,d as w,e as y,f as D}from"./breadcrumb-CVfpatPu.js";import{S as m}from"./separator-OWjsBv_k.js";import{B as x}from"./button-BfCUFj2v.js";import{I as n}from"./input-DPP4pqCX.js";import ae from"./ClientAddresses-C_5ULlHS.js";import{L as t}from"./label-2wttpgDy.js";import{S as E,a as I,b as L,c as k,d as B}from"./select-CnJHFvlZ.js";import{S as te}from"./switch-DN0b9m47.js";import{A as R,a as T,b as $,c as M,d as V,e as q,f as H,g as J,h as O}from"./alert-dialog-IHHWyKpT.js";import{t as l}from"./index-CGbDflUn.js";import ie from"./ClientJobs-Cbl6waG3.js";import ne from"./ClientSubClients-ojoMN5gT.js";import{A as le}from"./arrow-left-BksZfyPd.js";import{S as ce}from"./save-CPnrAY8Z.js";import{T as oe}from"./trash-2-BuUhqBcA.js";import"./index-B6zYnIfL.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./index-uXkLkjFM.js";import"./createLucideIcon-YMZQpf5O.js";import"./index-CpwjmW8Z.js";import"./Combination-DnQhWoyI.js";import"./index-Drt13xjj.js";import"./index-DdQz_MXT.js";import"./index-Dy7fGhxC.js";import"./index-BlL_lDRx.js";import"./index---YqbKSt.js";import"./data-table-DyHF-acO.js";import"./table-B3GsT3Yk.js";import"./columns-C__I2ANo.js";import"./dialog-0RdKrRPh.js";import"./square-pen-DlkBvHz6.js";import"./data-table-CRTt3Mt1.js";import"./columns-BEE2vL_W.js";import"./badge-BZbc9Efx.js";import"./user-DL4jvKNs.js";import"./eye-CPdCNAC_.js";import"./data-table-Bdx1BUcI.js";import"./columns-BHrjIhAm.js";function We({user_edit:i,client_details:o,customer_types:z,industries:N,lead_sources:b}){var A,F;if(!i||!o||!z||!N)return e.jsx("div",{children:"Loading..."});const[r,j]=g.useState({name:i.name||"",email:i.email||"",position:i.position||"",landline:i.landline||"",mobile:i.mobile||"",active:i.active||!1,address:o.address||"",town_city:o.town_city||"",county:o.county||"",postcode:o.postcode||"",contact_name:o.contact_name||"",sic_code:o.sic_code||"",customer_notes:o.customer_notes||"",customer_type_id:String(o.customer_type_id)||"",industry_id:String(o.industry_id)||"",lead_source_id:String(o.lead_source_id)||""}),[h,v]=g.useState({newPassword:"",confirmPassword:""}),[p,C]=g.useState({name:"",email:""}),[S,P]=g.useState(!1),_=()=>C({name:"",email:""}),c=s=>{const{name:a,value:d}=s.target;j(u=>({...u,[a]:d})),_()},G=s=>{j(a=>({...a,active:s}))},K=async()=>{var s,a;_();try{P(!0);const d={...r,customer_type_id:r.customer_type_id||null,industry_id:r.industry_id||null};(await f.put(`/customers/update/${i.id}`,d)).status===200?l.success("Client successfully updated!"):l.error("Failed to update client. Please try again.")}catch(d){(a=(s=d.response)==null?void 0:s.data)!=null&&a.errors?C(d.response.data.errors):l.error("An error occurred while updating the client.")}finally{P(!1)}},Q=async()=>{try{(await f.delete(`/customers/delete/${i.id}`)).status===200?(l.success("Client account successfully deleted!"),window.location.href="/customers"):l.error("Failed to delete account. Please try again.")}catch{l.error("An error occurred while deleting the account.")}},U=async()=>{try{(await f.post(`/customers/${i.id}/send-reset-email`)).status===200?l.success("Password reset email sent successfully."):l.error("Failed to send password reset email.")}catch{l.error("An error occurred while sending the password reset email.")}},W=async()=>{var s,a;if(h.newPassword!==h.confirmPassword){l.error("Passwords do not match.");return}try{await f.post(`/customers/${i.id}/reset-password`,{password:h.newPassword,password_confirmation:h.confirmPassword}),l.success("Password reset successfully."),v({newPassword:"",confirmPassword:""})}catch(d){(a=(s=d.response)==null?void 0:s.data)!=null&&a.errors?Object.values(d.response.data.errors).forEach(u=>{l.error(u[0])}):l.error("An error occurred while resetting the password.")}};return e.jsxs(X,{children:[e.jsx(Y,{}),e.jsxs(Z,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 bg-white border-b",children:[e.jsx(ee,{className:"-ml-1"}),e.jsx(m,{orientation:"vertical",className:"h-4 mx-2"}),e.jsx(se,{children:e.jsxs(re,{children:[e.jsx(w,{children:e.jsx(y,{href:"/",children:"Dashboard"})}),e.jsx(D,{}),e.jsx(w,{children:e.jsx(y,{href:"/customers",children:"Customers"})}),e.jsx(D,{}),e.jsx(w,{children:e.jsx(y,{href:"#",children:"Edit Customer"})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-3xl font-semibold text-gray-800",children:"Settings: Edit Customer Account"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(x,{variant:"outline",onClick:()=>window.location.href=`/customers/${i.id}`,children:[e.jsx(le,{className:"h-6 w-6 mr-0"}),"Done Editing"]}),e.jsx(x,{className:"bg-green-500 text-white hover:bg-green-600 focus:ring-2 focus:ring-green-400",onClick:K,disabled:S,children:S?e.jsx("span",{children:"Saving..."}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-5 w-5"}),"Save Changes"]})})]})]}),e.jsxs("div",{className:"flex flex-col gap-6 p-0",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold leading-7 text-gray-900 flex justify-between items-center",children:["Customer Details",e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Account Status:"}),e.jsx("span",{className:`text-sm px-4 py-1 rounded-sm ${r.active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"} font-medium`,children:r.active?"Active":"Disabled"})]})]}),e.jsx(m,{className:"my-4"}),e.jsxs("div",{className:"grid gap-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"name",className:"text-left",children:"Company Name*"}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(n,{id:"name",name:"name",value:r.name,onChange:c,required:!0}),p.name&&e.jsx("p",{className:"text-red-600 text-sm",children:p.name})]})]}),e.jsx(m,{}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"address",className:"text-left",children:"Address"}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{id:"address",name:"address",value:r.address,onChange:c})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"town_city",className:"text-left",children:"Town/City"}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{id:"town_city",name:"town_city",value:r.town_city,onChange:c})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"county",className:"text-left",children:"County"}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{id:"county",name:"county",value:r.county,onChange:c})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"postcode",className:"text-left",children:"Postcode"}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{id:"postcode",name:"postcode",value:r.postcode,onChange:c})})]}),e.jsx(m,{}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"contact_name",className:"text-left",children:"Contact Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{id:"contact_name",name:"contact_name",value:r.contact_name,onChange:c})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"position",className:"text-left",children:"Position"}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{id:"position",name:"position",value:r.position,onChange:c})})]}),e.jsx(m,{}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"landline",className:"text-left",children:"Landline"}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{id:"landline",name:"landline",value:r.landline,onChange:c})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"mobile",className:"text-left",children:"Mobile"}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{id:"mobile",name:"mobile",value:r.mobile,onChange:c})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"email",className:"text-left",children:"Email*"}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(n,{id:"email",name:"email",type:"email",value:r.email,onChange:c,required:!0}),p.email&&e.jsx("p",{className:"text-red-600 text-sm",children:p.email})]})]})]})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"More Details"}),e.jsx(m,{}),e.jsxs("div",{className:"grid gap-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"lead_source_id",className:"text-left",children:"Lead Source"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(E,{onValueChange:s=>j(a=>({...a,lead_source_id:s})),value:String(r.lead_source_id||""),children:[e.jsx(I,{className:"w-full",children:e.jsx(L,{placeholder:"Select Lead Source",children:((A=b.find(s=>String(s.id)===r.lead_source_id))==null?void 0:A.ls_name)||"Select Lead Source"})}),e.jsx(k,{children:b.map(s=>e.jsx(B,{value:String(s.id),children:s.ls_name},s.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"industry_id",className:"text-left",children:"Industry"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(E,{onValueChange:s=>j(a=>({...a,industry_id:s})),value:String(r.industry_id||""),children:[e.jsx(I,{className:"w-full",children:e.jsx(L,{placeholder:"Select Industry",children:((F=N.find(s=>String(s.id)===r.industry_id))==null?void 0:F.in_name)||"Select Industry"})}),e.jsx(k,{children:N.map(s=>e.jsx(B,{value:String(s.id),children:s.in_name},s.id))})]})})]}),e.jsx(m,{}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"sic_code",className:"text-left",children:"SIC Code"}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{id:"sic_code",name:"sic_code",value:r.sic_code,onChange:c})})]}),e.jsx(m,{}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"customer_notes",className:"text-left",children:"Customer Notes"}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{id:"customer_notes",name:"customer_notes",value:r.customer_notes,onChange:c})})]})]})]})]}),e.jsxs("section",{children:[e.jsx(ie,{parentId:i.id}),e.jsx("div",{className:"mt-6",children:e.jsx(ae,{parentId:i.id})}),e.jsx("div",{className:"mt-6",children:e.jsx(ne,{parentId:i.id})})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"Account Settings"}),e.jsx(m,{className:"mb-6"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("h3",{className:"text-base font-medium",children:"Reset Password"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Reset the client's password."}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx(x,{variant:"outline",onClick:U,children:"Email Password Reset"}),e.jsxs(R,{children:[e.jsx(T,{asChild:!0,children:e.jsx(x,{variant:"outline",children:"Manual Password Reset"})}),e.jsxs($,{children:[e.jsxs(M,{children:[e.jsx(V,{children:"Manual Password Reset"}),e.jsx(q,{children:"Enter the new password below to manually reset the client's password."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"newPassword",children:"New Password"}),e.jsx(n,{id:"newPassword",name:"newPassword",type:"password",value:h.newPassword,onChange:s=>v(a=>({...a,newPassword:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(n,{id:"confirmPassword",name:"confirmPassword",type:"password",value:h.confirmPassword,onChange:s=>v(a=>({...a,confirmPassword:s.target.value}))})]})]}),e.jsxs(H,{children:[e.jsx(J,{children:"Cancel"}),e.jsx(O,{onClick:W,children:"Save"})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("h3",{className:"text-base font-medium",children:"Disable Account"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Disable this client account from being accessed."}),e.jsx(te,{className:"mt-4",checked:!r.active,onCheckedChange:s=>G(!s)})]}),e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("h3",{className:"text-base font-medium",children:"Delete Account"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Permanently remove this client account from the system."}),e.jsxs(R,{children:[e.jsx(T,{asChild:!0,children:e.jsxs(x,{variant:"destructive",className:"mt-4",children:[e.jsx(oe,{className:"h-5 w-5 mr-2"}),"Delete Account"]})}),e.jsxs($,{children:[e.jsxs(M,{children:[e.jsx(V,{children:"Confirm Deletion"}),e.jsx(q,{children:"Are you sure you want to delete this client account? This action cannot be undone."})]}),e.jsxs(H,{children:[e.jsx(J,{children:"Cancel"}),e.jsx(O,{onClick:Q,children:"Confirm"})]})]})]})]})]})]})]})]})]})]})}export{We as default};
