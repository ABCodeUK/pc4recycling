import{r as l,j as e,b as D}from"./app-Cma8V3l9.js";import{S as Q,A as V,a as X,b as Y,B as Z,c as ee,d as u,e as p,f as S}from"./breadcrumb-Cr6GXjz3.js";import{S as E}from"./separator-CEPuzrhi.js";import{B as i}from"./button-DS1ZOJ9c.js";import{I as C}from"./input-_RUYSLpp.js";import{L as k}from"./label-IUEK5zVZ.js";import{DataTable as se}from"./data-table-BrjcpBoW.js";import{columns as ae}from"./columns-Dn92adOx.js";import{D as T,a as re,b as I,c as B,d as P,e as L,f as O}from"./dialog-C3tgJ_8I.js";import{A as te,a as le,b as ie,c as ne,d as oe,e as de,f as ce,g as me,h as he}from"./alert-dialog-BGiwvZFs.js";import{t as r}from"./index-C_iezvca.js";import{A as xe}from"./arrow-left-TMV1_Fg0.js";import{S as fe}from"./square-pen-DsVzVgxC.js";import{T as ue}from"./trash-2-DUTB_MOx.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./index-BH7C-wFc.js";import"./createLucideIcon-BnM-jrHn.js";import"./index-jFmiJHnk.js";import"./index-rOaI9F-v.js";import"./index-BUxlmQ7d.js";import"./index-Dp-u-l4U.js";import"./index-DHxxav9I.js";import"./index-CoYLIXTa.js";import"./index-CJRq-bCV.js";import"./index-Cdv8n69u.js";import"./index-CIrE5OO0.js";import"./calendar-TwlUnTX4.js";import"./table-vJebbvAp.js";import"./select-DcwlFvdE.js";import"./index-CrYhDhYK.js";function Ke({roles:z}){const[H,j]=l.useState(z),[w,N]=l.useState({name:""}),[v,A]=l.useState({name:""}),[d,c]=l.useState({name:""}),[y,_]=l.useState(""),[pe,m]=l.useState(!1),[g,R]=l.useState(null),[$,h]=l.useState(!1),[q,x]=l.useState(!1),f=()=>c({name:""}),b=()=>{N({name:""}),f()},F=(s,a)=>{const{name:t,value:n}=s.target;a==="add"?N(o=>({...o,[t]:n})):A(o=>({...o,[t]:n})),c(o=>({...o,[t]:""}))},M=s=>_(s.target.value),U=async()=>{f();try{m(!0);const s=await D.post("/settings/staff/roles",w);if(s.status===200){const a=s.data;j(t=>[...t,a]),b(),h(!1),r.success("Role successfully created!")}else r.error("Failed to create role. Please try again.")}catch(s){s.response&&s.response.data.errors?c(s.response.data.errors):r.error("Error creating role. Please check the logs.")}finally{m(!1)}},W=async()=>{if(g){f();try{m(!0);const s=await D.put(`/settings/staff/roles/${g}`,v);if(s.status===200){const a=s.data;j(t=>t.map(n=>n.id===g?a:n)),R(null),x(!1),r.success("Role successfully updated!")}else r.error("Failed to update role. Please try again.")}catch(s){s.response&&s.response.data.errors?c(s.response.data.errors):r.error("Error updating role. Please check the logs.")}finally{m(!1)}}},G=async s=>{try{const a=await D.delete(`/settings/staff/roles/${s}`);a.status===200?(j(t=>t.filter(n=>n.id!==s)),r.success("Role successfully deleted!")):r.error(a.data.message||"Failed to delete role. Please try again.")}catch(a){a.response&&a.response.data.message?r.error(a.response.data.message):r.error("Error deleting role. Please check the logs.")}},J=H.filter(s=>s.name.toLowerCase().includes(y.toLowerCase())),K=[...ae,{id:"actions",header:()=>e.jsx("div",{className:"text-right",children:"Actions"}),cell:({row:s})=>{const a=s.original;return e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>{A({name:a.name}),f(),R(a.id),x(!0)},children:e.jsx(fe,{className:"h-4 w-4"})}),e.jsxs(te,{children:[e.jsx(le,{asChild:!0,children:e.jsx(i,{variant:"destructive",size:"sm",disabled:a.userCount>0,title:a.userCount>0?"Cannot delete a role with assigned users":void 0,children:e.jsx(ue,{className:"h-4 w-4"})})}),!a.userCount&&e.jsxs(ie,{children:[e.jsxs(ne,{children:[e.jsx(oe,{children:"Confirm Deletion"}),e.jsxs(de,{children:["Are you sure you want to delete role ",e.jsx("b",{children:a.name}),"? This action cannot be undone."]})]}),e.jsxs(ce,{children:[e.jsx(me,{children:"Cancel"}),e.jsx(he,{onClick:()=>G(a.id),children:"Delete"})]})]})]})]})}}];return e.jsxs(Q,{children:[e.jsx(V,{}),e.jsxs(X,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 bg-white border-b",children:[e.jsx(Y,{className:"-ml-1"}),e.jsx(E,{orientation:"vertical",className:"h-4 mx-2"}),e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(u,{children:e.jsx(p,{href:"/",children:"Dashboard"})}),e.jsx(S,{}),e.jsx(u,{children:e.jsx(p,{href:"/settings",children:"Settings"})}),e.jsx(S,{}),e.jsx(u,{children:e.jsx(p,{href:"/settings/staff",children:"Staff Accounts"})}),e.jsx(S,{}),e.jsx(u,{children:e.jsx(p,{href:"/settings/staff/roles",children:"Staff Roles"})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-3xl font-semibold text-gray-800",children:"Settings: Staff Roles"})}),e.jsxs(i,{variant:"outline",onClick:()=>window.location.href="/settings/staff/",children:[e.jsx(xe,{className:"h-6 w-6"}),"Staff Accounts"]})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Manage Roles"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, edit, or delete roles used in the system."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(C,{placeholder:"Search Roles...",value:y,onChange:M,className:"max-w-sm"}),e.jsxs(T,{open:$,onOpenChange:s=>{s||b(),h(s)},children:[e.jsx(re,{asChild:!0,children:e.jsx(i,{onClick:()=>h(!0),children:"Add New Role"})}),e.jsxs(I,{className:"sm:max-w-[425px] bg-white",children:[e.jsxs(B,{children:[e.jsx(P,{children:"Add New Role"}),e.jsx(L,{children:"Fill in the details for the new role below."})]}),e.jsx("div",{className:"bg-white border rounded-lg p-6",children:e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{children:[e.jsx(k,{htmlFor:"name",children:"Role Name"}),e.jsx(C,{id:"name",name:"name",value:w.name,onChange:s=>F(s,"add")}),d.name&&e.jsx("p",{className:"text-red-600 text-sm",children:d.name})]})})}),e.jsxs(O,{children:[e.jsx(i,{variant:"outline",onClick:()=>{b(),h(!1)},children:"Cancel"}),e.jsx(i,{onClick:U,children:"Create Role"})]})]})]})]})]}),e.jsx(E,{className:"my-4"}),e.jsx(se,{columns:K,data:J})]}),e.jsx(T,{open:q,onOpenChange:x,children:e.jsxs(I,{className:"sm:max-w-[425px] bg-white",children:[e.jsxs(B,{children:[e.jsx(P,{children:"Edit Role"}),e.jsx(L,{children:"Update the details for the role below."})]}),e.jsx("div",{className:"bg-white border rounded-lg p-6",children:e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{children:[e.jsx(k,{htmlFor:"name_edit",children:"Role Name"}),e.jsx(C,{id:"name_edit",name:"name",value:v.name,onChange:s=>F(s,"edit")}),d.name&&e.jsx("p",{className:"text-red-600 text-sm",children:d.name})]})})}),e.jsxs(O,{children:[e.jsx(i,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(i,{onClick:W,children:"Save Changes"})]})]})})]})]})]})}export{Ke as default};
