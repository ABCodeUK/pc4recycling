import{r as k,j as e,b as M,h as T}from"./app-DGedXpK6.js";import{S as E,A as P,a as q,b as C,B as I,c as H,d as y,e as b,f as z}from"./breadcrumb-DVHq5Awm.js";import{S as c}from"./separator-Qg1edzKM.js";import{B as r}from"./button-DjXm1grC.js";import{I as _}from"./input-CkBA5yRJ.js";import{t as f}from"./index-B34HRg7w.js";import J from"./JobItems-D2vuQaVr.js";import{c as S}from"./createLucideIcon-C-iaKTyE.js";import{A as O}from"./arrow-left-DY8IiIyw.js";import{S as R}from"./square-pen-DAP9x76s.js";import{T as N}from"./trash-2-CE_77rkt.js";import"./index-Dx4p5O6H.js";import"./index-BOJ2gww-.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./index-D1brpkaJ.js";import"./index-BNfd2_2U.js";import"./index-CLFtQT3G.js";import"./index-Crf3phMa.js";import"./index-B_qNjpXx.js";import"./index-CvV_Mgk0.js";import"./index-DYpMfZUf.js";import"./tabs-BDf_6eYd.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=S("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p=S("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function fe({job:a,customers:D,documents:$}){const[i,j]=k.useState($||{collection_manifest:null,hazard_waste_note:null,data_destruction_certificate:null,other:[]}),[x,w]=k.useState({collection_manifest:null,hazard_waste_note:null,data_destruction_certificate:null,other:null}),h=async t=>{const o=x[t];if(!o)return;const n=new FormData;n.append("document",o),n.append("document_type",t);try{const d=await M.post(`/collections/${a.id}/documents`,n,{headers:{"Content-Type":"multipart/form-data"}});d.data&&(j(t==="other"?m=>({...m,other:[...m.other,d.data.document]}):m=>({...m,[t]:d.data.document})),w(m=>({...m,[t]:null})),f.success("Document uploaded successfully"))}catch(d){console.error("Upload error:",d),f.error("Failed to upload document")}},g=(t,o)=>{var d;const n=(d=t.target.files)==null?void 0:d[0];if(n){if(n.size>134217728){f.error("File size must be less than 128MB"),t.target.value="";return}w(B=>({...B,[o]:n}))}};r,x.collection_manifest;const u=(t,o)=>{T.delete(`/collections/${a.id}/documents/${t}`,{preserveScroll:!0,onSuccess:()=>{j(o==="other"?n=>({...n,other:n.other.filter(d=>d.id!==t)}):n=>({...n,[o]:null})),f.success("Document deleted successfully")},onError:()=>{f.error("Failed to delete document")}})},l=({label:t,value:o})=>e.jsxs("div",{className:"py-1 grid grid-cols-2",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:t}),e.jsx("dd",{className:"text-sm text-gray-900 text-left",children:o||"-"})]}),A=t=>t==="Active"?"bg-green-100 text-green-700 border-green-200":"bg-red-100 text-red-700 border-red-200",F=t=>{switch(t){case"Scheduled":return"bg-green-100 text-green-800 border-green-200";case"Postponed":case"Cancelled":return"bg-red-100 text-red-800 border-red-200";case"Collected":case"Processing":case"Complete":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},s=D.find(t=>t.id===a.client_id),L=a.collection_date?new Date(a.collection_date).toLocaleDateString():"-";return e.jsxs(E,{children:[e.jsx(P,{}),e.jsxs(q,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 bg-white border-b",children:[e.jsx(C,{className:"-ml-1"}),e.jsx(c,{orientation:"vertical",className:"h-4 mx-2"}),e.jsx(I,{children:e.jsxs(H,{children:[e.jsx(y,{children:e.jsx(b,{href:"/dashboard",children:"Dashboard"})}),e.jsx(z,{}),e.jsx(y,{children:e.jsx(b,{href:"/collections",children:"Collections"})}),e.jsx(z,{}),e.jsx(y,{children:e.jsx(b,{href:"#",children:"View Job"})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-3xl font-semibold text-gray-800",children:["Collection: ",a.job_id]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(r,{variant:"outline",onClick:()=>window.location.href="/collections",children:[e.jsx(O,{className:"h-6 w-6"}),"Back to Collections"]}),e.jsxs(r,{onClick:()=>window.location.href=`/collections/${a.id}/edit`,children:[e.jsx(R,{className:"h-6 w-6"}),"Edit Job"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold leading-7 text-gray-900 flex justify-between items-center",children:["Collection Details",e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium border ${F(a.job_status)}`,children:a.job_status})]})]}),e.jsx(c,{className:"my-4"}),e.jsxs("dl",{className:"grid gap-2",children:[e.jsx(l,{label:"Job Number",value:a.job_id}),e.jsxs("div",{className:"py-1 grid grid-cols-2",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Customer"}),e.jsx("dd",{className:"text-sm text-left",children:e.jsx("a",{href:`/customers/${s==null?void 0:s.id}`,className:"text-primary hover:text-primary/90",children:(s==null?void 0:s.company_name)||(s==null?void 0:s.name)||"-"})})]}),e.jsx(l,{label:"Collection Date",value:L}),e.jsx(c,{className:"my-2"}),e.jsx(l,{label:"Staff Collecting",value:a.staff_collecting||"-"}),e.jsx(l,{label:"Vehicle",value:a.vehicle||"-"}),e.jsx(c,{className:"my-2"}),e.jsx(l,{label:"Address Line 1",value:a.address}),e.jsx(l,{label:"Address Line 2",value:a.address_2}),e.jsx(l,{label:"Town/City",value:a.town_city}),e.jsx(l,{label:"Postcode",value:a.postcode}),e.jsx(c,{className:"my-2"}),e.jsx(l,{label:"Onsite Contact",value:a.onsite_contact||"-"}),e.jsx(l,{label:"Onsite Number",value:a.onsite_number||"-"}),e.jsx(l,{label:"Onsite Email",value:a.onsite_email||"-"})]})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"More Information"}),e.jsx(c,{className:"my-4"}),e.jsxs("dl",{className:"grid gap-2",children:[e.jsx(l,{label:"Collection Type",value:a.collection_type||"-"}),e.jsx(l,{label:"Data Sanitisation",value:a.data_sanitisation||"-"}),e.jsx(l,{label:"Service Level Agreement",value:a.sla||"-"}),e.jsx(c,{className:"my-2"}),e.jsx(l,{label:"Equipment Location",value:a.equipment_location||"-"}),e.jsx(l,{label:"Building Access",value:a.building_access||"-"}),e.jsx(l,{label:"Collection Route",value:a.collection_route||"-"}),e.jsx(l,{label:"Parking & Loading",value:a.parking_loading||"-"}),e.jsx(l,{label:"Equipment Readiness",value:a.equipment_readiness||"-"}),e.jsx(c,{className:"my-2"}),e.jsxs("div",{className:"py-1",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Other Information"}),e.jsx("dd",{className:"mt-2 text-sm text-gray-900",children:a.instructions||"No instructions provided."})]})]})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold leading-7 text-gray-900 flex justify-between items-center",children:["Customer Details",e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Account:"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium border ${A(s==null?void 0:s.account_status)}`,children:(s==null?void 0:s.account_status)||"Disabled"})]})]}),e.jsx(c,{className:"my-4"}),e.jsxs("dl",{className:"grid gap-2",children:[e.jsx(l,{label:"Company Name",value:(s==null?void 0:s.company_name)||(s==null?void 0:s.name)||"-"}),e.jsx(l,{label:"Address Line 1",value:(s==null?void 0:s.address)||"-"}),e.jsx(l,{label:"Address Line 2",value:(s==null?void 0:s.address_2)||"-"}),e.jsx(l,{label:"Town/City",value:(s==null?void 0:s.town_city)||"-"}),e.jsx(l,{label:"County",value:(s==null?void 0:s.county)||"-"}),e.jsx(l,{label:"Postcode",value:(s==null?void 0:s.postcode)||"-"}),e.jsx(c,{className:"my-2"}),e.jsx(l,{label:"Contact Name",value:(s==null?void 0:s.contact_name)||"-"}),e.jsx(l,{label:"Position",value:(s==null?void 0:s.position)||"-"}),e.jsx(l,{label:"Landline",value:(s==null?void 0:s.landline)||"-"}),e.jsx(l,{label:"Mobile",value:(s==null?void 0:s.mobile)||"-"}),e.jsx(l,{label:"Email",value:(s==null?void 0:s.email)||"-"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"Job Documents"}),e.jsx(c,{className:"my-4"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Collection Manifest"}),e.jsx("div",{className:"flex gap-2 items-center",children:i.collection_manifest?e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:`/documents/${a.job_id}/${i.collection_manifest.uuid}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-primary/90 flex items-center gap-2",children:[e.jsx(v,{className:"h-4 w-4"}),i.collection_manifest.original_filename]}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>i.collection_manifest&&u(i.collection_manifest.id,"collection_manifest"),children:e.jsx(N,{className:"h-4 w-4 text-red-500"})})]}):e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(_,{type:"file",accept:".pdf",onChange:t=>g(t,"collection_manifest")}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>h("collection_manifest"),disabled:!x.collection_manifest,children:e.jsx(p,{className:"h-4 w-4"})})]})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Hazard Waste Note"}),e.jsx("div",{className:"flex gap-2 items-center",children:i.hazard_waste_note?e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:`/documents/${a.job_id}/${i.hazard_waste_note.uuid}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-primary/90 flex items-center gap-2",children:[e.jsx(v,{className:"h-4 w-4"}),i.hazard_waste_note.original_filename]}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>i.hazard_waste_note&&u(i.hazard_waste_note.id,"hazard_waste_note"),children:e.jsx(N,{className:"h-4 w-4 text-red-500"})})]}):e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(_,{type:"file",accept:".pdf",onChange:t=>g(t,"hazard_waste_note")}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>h("hazard_waste_note"),disabled:!x.hazard_waste_note,children:e.jsx(p,{className:"h-4 w-4"})})]})})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Data Destruction Certificate"}),e.jsx("div",{className:"flex gap-2 items-center",children:i.data_destruction_certificate?e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:`/documents/${a.job_id}/${i.data_destruction_certificate.uuid}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-primary/90 flex items-center gap-2",children:[e.jsx(v,{className:"h-4 w-4"}),i.data_destruction_certificate.original_filename]}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>i.data_destruction_certificate&&u(i.data_destruction_certificate.id,"data_destruction_certificate"),children:e.jsx(N,{className:"h-4 w-4 text-red-500"})})]}):e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(_,{type:"file",accept:".pdf",onChange:t=>g(t,"data_destruction_certificate")}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>h("data_destruction_certificate"),disabled:!x.data_destruction_certificate,children:e.jsx(p,{className:"h-4 w-4"})})]})})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Other Documents"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(_,{type:"file",accept:".pdf",onChange:t=>g(t,"other")}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>h("other"),disabled:!x.other,children:e.jsx(p,{className:"h-4 w-4"})})]}),i.other.length>0&&e.jsx("div",{className:"space-y-2",children:i.other.map(t=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsxs("a",{href:`/documents/${a.job_id}/${t.uuid}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-primary/90 flex items-center gap-2",children:[e.jsx(v,{className:"h-4 w-4"}),t.original_filename]}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>u(t.id,"other"),children:e.jsx(N,{className:"h-4 w-4 text-red-500"})})]},t.id))})]})]})]})]}),e.jsx("section",{children:"hello"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx("section",{children:e.jsx(J,{})})})]})]})]})}export{fe as default};
