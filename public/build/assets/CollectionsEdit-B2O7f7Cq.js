import{r as f,j as e,h as O,b as $}from"./app-CxxjQbGd.js";import{S as H,A as R,a as q,b as z,B as G,c as K,d as _,e as y,f as F}from"./breadcrumb-CVfpatPu.js";import{S as m}from"./separator-OWjsBv_k.js";import{B as b}from"./button-BfCUFj2v.js";import{I as r}from"./input-DPP4pqCX.js";import{L as l}from"./label-2wttpgDy.js";import{S as x,a as j,b as g,c as p,d as o}from"./select-CnJHFvlZ.js";import{t as v}from"./index-CGbDflUn.js";import{A as Q,a as U,b as W,c as X,d as Y,e as Z,f as ee,g as se,h as ie}from"./alert-dialog-IHHWyKpT.js";import{A as le}from"./arrow-left-BksZfyPd.js";import{S as ae}from"./save-CPnrAY8Z.js";import{T as ce}from"./trash-2-BuUhqBcA.js";import"./index-B6zYnIfL.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./index-uXkLkjFM.js";import"./createLucideIcon-YMZQpf5O.js";import"./index-CpwjmW8Z.js";import"./Combination-DnQhWoyI.js";import"./index-Drt13xjj.js";import"./index-DdQz_MXT.js";import"./index-Dy7fGhxC.js";import"./index-BlL_lDRx.js";import"./index---YqbKSt.js";function Ee({job:a,customers:S,addresses:w,collection_types:E,sanitisation_options:T,status_options:B,staff_members:C}){var D;const[I,N]=f.useState(!1),P=async()=>{try{N(!0),O.delete(`/collections/${a.id}`,{onSuccess:()=>{v.success("Job successfully deleted!"),window.location.href="/collections"},onError:()=>{v.error("Failed to delete job. Please try again.")},onFinish:()=>{N(!1)}})}catch{v.error("Failed to delete job. Please try again."),N(!1)}},[c,h]=f.useState({job_id:a.job_id||"",client_id:((D=a.client_id)==null?void 0:D.toString())||"",collection_date:a.collection_date?new Date(a.collection_date).toISOString().split("T")[0]:"",job_status:a.job_status||"",staff_collecting:a.staff_collecting||"",vehicle:a.vehicle||"",address:a.address||"",town_city:a.town_city||"",postcode:a.postcode||"",onsite_contact:a.onsite_contact||"",onsite_number:a.onsite_number||"",onsite_email:a.onsite_email||"",collection_type:a.collection_type||"",data_sanitisation:a.data_sanitisation||"",sla:a.sla||"",instructions:a.instructions||""}),[V,A]=f.useState(!1),d=s=>{const{name:t,value:n}=s.target;h(M=>({...M,[t]:n}))},u=(s,t)=>{h(n=>({...n,[s]:t}))},L=s=>{if(s==="manual"){h(n=>({...n,staff_collecting:""}));return}const t=C.find(n=>n.id.toString()===s);t&&h(n=>({...n,staff_collecting:t.name}))},k=s=>{if(s==="manual"){h(n=>({...n,address:"",town_city:"",county:"",postcode:""}));return}if(s==="main"){i&&h(n=>({...n,address:i.address||"",town_city:i.town_city||"",county:i.county||"",postcode:i.postcode||""}));return}const t=w.find(n=>n.id.toString()===s);t&&h(n=>({...n,address:t.address,town_city:t.town_city,county:t.county||"",postcode:t.postcode}))},J=async()=>{try{A(!0),(await $.put(`/collections/${a.id}`,c)).status===200?v.success("Changes saved successfully!"):v.error("Failed to save changes. Please try again.")}catch{v.error("An error occurred while saving changes.")}finally{A(!1)}},i=S.find(s=>s.id.toString()===c.client_id);return e.jsxs(H,{children:[e.jsx(R,{}),e.jsxs(q,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 bg-white border-b",children:[e.jsx(z,{className:"-ml-1"}),e.jsx(m,{orientation:"vertical",className:"h-4 mx-2"}),e.jsx(G,{children:e.jsxs(K,{children:[e.jsx(_,{children:e.jsx(y,{href:"/dashboard",children:"Dashboard"})}),e.jsx(F,{}),e.jsx(_,{children:e.jsx(y,{href:"/collections",children:"Collections"})}),e.jsx(F,{}),e.jsx(_,{children:e.jsx(y,{href:"#",children:"Edit Job"})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-3xl font-semibold text-gray-800",children:["Collection: ",a.job_id]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(b,{variant:"outline",onClick:()=>window.location.href=`/collections/${a.id}`,children:[e.jsx(le,{className:"h-6 w-6"}),"Done Editing"]}),e.jsxs(b,{className:"bg-green-500 text-white hover:bg-green-600 focus:ring-2 focus:ring-green-400",onClick:J,disabled:V,children:[e.jsx(ae,{className:"h-6 w-6"}),"Save Changes"]}),e.jsxs(Q,{children:[e.jsx(U,{asChild:!0,children:e.jsxs(b,{className:"bg-red-500 text-white hover:bg-red-600 focus:ring-2 focus:ring-red-400",disabled:I,children:[e.jsx(ce,{className:"h-6 w-6"}),"Delete Job"]})}),e.jsxs(W,{children:[e.jsxs(X,{children:[e.jsx(Y,{children:"Confirm Deletion"}),e.jsx(Z,{children:"Are you sure you want to delete this job? This action cannot be undone."})]}),e.jsxs(ee,{children:[e.jsx(se,{children:"Cancel"}),e.jsx(ie,{onClick:P,children:"Delete"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("section",{className:"bg-white border shadow rounded-lg",children:[e.jsx("header",{className:"p-6",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Collection Details"})}),e.jsx(m,{}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"job_id",children:"Job Number*"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"job_id",name:"job_id",value:c.job_id,onChange:d})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"client_id",children:"Customer*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(x,{value:c.client_id,onValueChange:s=>u("client_id",s),children:[e.jsx(j,{children:e.jsx(g,{placeholder:"Select Customer"})}),e.jsx(p,{children:S.map(s=>e.jsx(o,{value:s.id.toString(),children:s.company_name||s.name},s.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"collection_date",children:"Collection Date*"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"collection_date",name:"collection_date",type:"date",value:c.collection_date,onChange:d})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"job_status",children:"Status*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(x,{value:c.job_status,onValueChange:s=>u("job_status",s),children:[e.jsx(j,{children:e.jsx(g,{placeholder:"Select Status"})}),e.jsx(p,{children:B.map(s=>e.jsx(o,{value:s,children:s},s))})]})})]})]}),e.jsx(m,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"staff_select",children:"Staff Collecting"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(x,{onValueChange:L,children:[e.jsx(j,{children:e.jsx(g,{placeholder:"Enter Manually"})}),e.jsxs(p,{children:[e.jsx(o,{value:"manual",children:"Enter Manually"}),C.map(s=>e.jsx(o,{value:s.id.toString(),children:s.name},s.id))]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"staff_collecting",children:"Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"staff_collecting",name:"staff_collecting",value:c.staff_collecting,onChange:d})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"vehicle",children:"Vehicle"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"vehicle",name:"vehicle",value:c.vehicle,onChange:d})})]})]}),e.jsx(m,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"collection_address",children:"Collection Address"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(x,{onValueChange:k,children:[e.jsx(j,{children:e.jsx(g,{placeholder:"Enter Manually"})}),e.jsxs(p,{children:[e.jsx(o,{value:"manual",children:"Enter Manually"}),i&&i.address&&e.jsxs(o,{value:"main",children:[i.address,", ",i.town_city,", ",i.postcode]}),w.map(s=>e.jsxs(o,{value:s.id.toString(),children:[s.address,", ",s.postcode]},s.id))]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"address",children:"Address*"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"address",name:"address",value:c.address,onChange:d})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"town_city",children:"Town/City*"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"town_city",name:"town_city",value:c.town_city,onChange:d})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"county",children:"County"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"county",name:"county",value:c.county||"",onChange:d})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"postcode",children:"Postcode*"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"postcode",name:"postcode",value:c.postcode,onChange:d})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"onsite_contact",children:"Onsite Contact"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"onsite_contact",name:"onsite_contact",value:c.onsite_contact,onChange:d})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"onsite_number",children:"Onsite Number"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"onsite_number",name:"onsite_number",value:c.onsite_number,onChange:d})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"onsite_email",children:"Onsite Email"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"onsite_email",name:"onsite_email",type:"email",value:c.onsite_email,onChange:d})})]})]}),e.jsx(m,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"collection_type",children:"Collection Type*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(x,{value:c.collection_type,onValueChange:s=>u("collection_type",s),children:[e.jsx(j,{children:e.jsx(g,{placeholder:"Select Collection Type"})}),e.jsx(p,{children:E.map(s=>e.jsx(o,{value:s,children:s},s))})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"data_sanitisation",children:"Data Sanitisation*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(x,{value:c.data_sanitisation,onValueChange:s=>u("data_sanitisation",s),children:[e.jsx(j,{children:e.jsx(g,{placeholder:"Select Sanitisation Option"})}),e.jsx(p,{children:T.map(s=>e.jsx(o,{value:s,children:s},s))})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{htmlFor:"sla",children:"Service Level Agreement"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"sla",name:"sla",value:c.sla,onChange:d})})]})]})]})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg self-start",children:[e.jsxs("div",{className:"flex items-center justify-between p-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Customer Details"}),e.jsxs("div",{className:"text-sm",children:["Account Status: ",e.jsx("span",{className:"text-green-500",children:"Active"})]})]}),e.jsx("hr",{className:"my-0"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{children:"Company Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.company_name)||(i==null?void 0:i.name)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{children:"Address"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.address)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{children:"Town/City"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.town_city)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{children:"County"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.county)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{children:"Postcode"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.postcode)||"-"})})]})]}),e.jsx(m,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{children:"Contact Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.contact_name)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{children:"Position"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.position)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{children:"Landline"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.landline)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{children:"Mobile"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.mobile)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(l,{children:"Email"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.email)||"-"})})]}),e.jsx(m,{}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"instructions",children:"Job Instructions"}),e.jsx("textarea",{id:"instructions",name:"instructions",rows:6,placeholder:"Please enter any notes about this job here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:c.instructions,onChange:d})]})]})]})]})]})]})]})]})}export{Ee as default};
