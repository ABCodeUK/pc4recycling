import{r as s,j as e}from"./app-CNWjOMNx.js";import{S as f,C as j}from"./checkbox-sJYclvVs.js";import{D as V,b as B,c as U,d as q,e as H}from"./dialog-BfgzRhkV.js";import{T as J,a as M,b as C,c as N}from"./tabs-plg5bBI7.js";import{B as o}from"./button-Cif8vmUM.js";import{L as i}from"./label-EHUiVpis.js";import{I as h}from"./input-CKARXW-H.js";import"./extends-CF3RwP-h.js";import"./index-DPKFiV9N.js";import"./index-D-4-NTWd.js";import"./index-BflIAMo0.js";import"./index-CNsmnkFI.js";import"./createLucideIcon-ClQ1hqbp.js";import"./index-BJMVI5o3.js";import"./index-DUDCROMg.js";import"./utils-CytzSlOG.js";import"./index-CnljWFNF.js";import"./index-BHpFse_T.js";import"./index-BqYSSVB3.js";import"./index-BwobEAja.js";function ce({isOpen:b,onClose:y,onComplete:S,defaultVehicle:D,defaultCustomerName:k}){const[P,v]=s.useState("customer"),[c,R]=s.useState(null),[d,T]=s.useState(k||""),[m,w]=s.useState(""),[u,E]=s.useState(D||""),[x,I]=s.useState(!1),[g,A]=s.useState(!1),l=s.useRef(null),n=s.useRef(null),F=()=>{var t,a;if(!x){alert("Please confirm the items list");return}if((t=l.current)!=null&&t.isEmpty()){alert("Please provide a signature");return}if(!d.trim()){alert("Please provide your name");return}const r=(a=l.current)==null?void 0:a.getCanvas();r&&(R(r.toDataURL()),v("driver"))},L=()=>{var t,a;if(!g){alert("Please confirm collection of all items");return}if((t=n.current)!=null&&t.isEmpty()){alert("Please provide a signature");return}if(!m.trim()){alert("Please provide your name");return}if(!u.trim()){alert("Please provide a vehicle registration");return}if(!c){alert("Customer signature is required");return}const r=(a=n.current)==null?void 0:a.getCanvas();r&&S(c,d,r.toDataURL(),m,u)},p=r=>{var t;(t=r.current)==null||t.clear()};return e.jsx(V,{open:b,onOpenChange:y,children:e.jsxs(B,{className:"max-w-3xl",children:[e.jsxs(U,{children:[e.jsx(q,{children:"Collection Signatures"}),e.jsx(H,{children:"Please collect signatures from both the customer and driver to mark this job as collected."})]}),e.jsxs(J,{value:P,onValueChange:v,children:[e.jsxs(M,{className:"grid w-full grid-cols-2",children:[e.jsx(C,{value:"customer",children:"Customer"}),e.jsx(C,{value:"driver",disabled:!c,children:"Driver"})]}),e.jsx(N,{value:"customer",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"border rounded-lg p-4",children:e.jsx(f,{ref:l,canvasProps:{className:"signature-canvas w-full h-[200px] border rounded-lg bg-white",style:{touchAction:"none"}}})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(i,{htmlFor:"customerName",children:"Customer Name"}),e.jsx(h,{id:"customerName",value:d,onChange:r=>T(r.target.value),placeholder:"Enter your name"})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"items-confirmed",checked:x,onCheckedChange:r=>I(r)}),e.jsx(i,{htmlFor:"items-confirmed",className:"text-sm",children:"I confirm that the items PC4Recycling are collecting are marked on the list."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(o,{variant:"outline",onClick:()=>p(l),children:"Clear"}),e.jsx(o,{onClick:F,children:"I Agree"})]})]})}),e.jsx(N,{value:"driver",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"border rounded-lg p-4",children:e.jsx(f,{ref:n,canvasProps:{className:"signature-canvas w-full h-[200px] border rounded-lg bg-white",style:{touchAction:"none"}}})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"driverName",children:"Driver Name"}),e.jsx(h,{id:"driverName",value:m,onChange:r=>w(r.target.value),placeholder:"Enter your name"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"Vehicle",children:"Vehicle Reg"}),e.jsx(h,{id:"vehicle",value:u,onChange:r=>E(r.target.value),placeholder:"Enter your Vehicle Reg"})]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"driver-confirmed",checked:g,onCheckedChange:r=>A(r)}),e.jsx(i,{htmlFor:"driver-confirmed",className:"text-sm",children:"I confirm that I have collected all items listed."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(o,{variant:"outline",onClick:()=>p(n),children:"Clear"}),e.jsx(o,{onClick:L,children:"Mark Job Collected"})]})]})})]})]})})}export{ce as default};
