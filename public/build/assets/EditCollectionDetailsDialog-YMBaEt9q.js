import{r as E,j as e,b as M}from"./app-CNWjOMNx.js";import{D as A,b as T,c as V,d as B,e as L,f as k}from"./dialog-BfgzRhkV.js";import{B as q}from"./button-Cif8vmUM.js";import{I as i}from"./input-CKARXW-H.js";import{L as r}from"./label-EHUiVpis.js";import{S as H}from"./separator-BPue9knr.js";import{c as h,d,S as u,a as j,b as _}from"./select-DyBRev3z.js";import{t as f}from"./index-DROTMuiR.js";import"./index-D-4-NTWd.js";import"./index-DPKFiV9N.js";import"./index-CnljWFNF.js";import"./index-BHpFse_T.js";import"./index-DUDCROMg.js";import"./index-BJMVI5o3.js";import"./utils-CytzSlOG.js";import"./createLucideIcon-ClQ1hqbp.js";import"./index-BwobEAja.js";import"./index-CmDO7QdU.js";import"./index-CNsmnkFI.js";import"./index-BqYSSVB3.js";import"./index-BflIAMo0.js";function te({isOpen:N,onClose:x,jobId:v,initialData:o,addresses:g,customers:C,job:y,sub_clients:p}){const[l,a]=E.useState({address:(o==null?void 0:o.address)??"",address_2:(o==null?void 0:o.address_2)??"",town_city:(o==null?void 0:o.town_city)??"",postcode:(o==null?void 0:o.postcode)??"",onsite_contact:(o==null?void 0:o.onsite_contact)??"",onsite_number:(o==null?void 0:o.onsite_number)??"",onsite_email:(o==null?void 0:o.onsite_email)??""}),n=C.find(s=>s.id===y.client_id),w=s=>{if(s==="manual"){a(c=>({...c,onsite_contact:"",onsite_number:"",onsite_email:""}));return}if(s==="main"&&n){a(c=>({...c,onsite_contact:n.name||"",onsite_number:n.mobile||n.landline||"",onsite_email:n.email||""}));return}const t=p.find(c=>c.id.toString()===s);t&&a(c=>({...c,onsite_contact:t.name,onsite_number:t.mobile||t.landline||"",onsite_email:t.email}))};h,n&&(d,n.name),p.map(s=>e.jsx(d,{value:s.id.toString(),children:s.name},s.id)),d;const S=s=>{if(s==="manual"){a(c=>({...c,address:"",address_2:"",town_city:"",postcode:""}));return}if(s==="main"&&n){a(c=>({...c,address:n.address||"",address_2:n.address_2||"",town_city:n.town_city||"",postcode:n.postcode||""}));return}const t=g.find(c=>c.id.toString()===s);t&&a(c=>({...c,address:t.address,address_2:t.address_2,town_city:t.town_city,postcode:t.postcode}))},m=s=>{const{name:t,value:c}=s.target;a(F=>({...F,[t]:c}))},b=async()=>{try{(await M.put(`/client/quotes/${v}/update`,l)).status===200&&(f.success("Collection details updated successfully"),x(),window.location.reload())}catch(s){console.error("Error updating collection details:",s),f.error("Failed to update collection details")}};return e.jsx(A,{open:N,onOpenChange:x,children:e.jsxs(T,{className:"sm:max-w-[525px]",children:[e.jsxs(V,{children:[e.jsx(B,{children:"Edit Collection Details"}),e.jsx(L,{children:"Update the collection address and contact details."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"address-select",className:"text-left",children:"Select Address"}),e.jsxs(u,{onValueChange:S,children:[e.jsx(j,{className:"w-full col-span-3",children:e.jsx(_,{placeholder:"Choose an address"})}),e.jsxs(h,{children:[n&&e.jsxs(d,{value:"main",children:[n.address,", ",n.town_city," ",n.postcode," (Main Contact)"]}),g.map(s=>e.jsxs(d,{value:s.id.toString(),children:[s.address,", ",s.town_city]},s.id)),e.jsx(d,{value:"manual",children:"Enter Manually"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"address",className:"text-left",children:"Address"}),e.jsx(i,{id:"address",name:"address",value:l.address,onChange:m,className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"address_2",className:"text-left",children:"Address 2"}),e.jsx(i,{id:"address_2",name:"address_2",value:l.address_2,onChange:m,className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"town_city",className:"text-left",children:"Town/City"}),e.jsx(i,{id:"town_city",name:"town_city",value:l.town_city,onChange:m,className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"postcode",className:"text-left",children:"Postcode"}),e.jsx(i,{id:"postcode",name:"postcode",value:l.postcode,onChange:m,className:"col-span-3"})]}),e.jsx(H,{className:"my-2"}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"contact-select",className:"text-left",children:"Select Contact"}),e.jsxs(u,{onValueChange:w,children:[e.jsx(j,{className:"w-full col-span-3",children:e.jsx(_,{placeholder:"Choose a contact"})}),e.jsxs(h,{children:[(o==null?void 0:o.onsite_contact)&&e.jsxs(d,{value:"main",children:[(n==null?void 0:n.name)||"Main Contact"," (Main Contact)"]}),p.map(s=>e.jsx(d,{value:s.id.toString(),children:s.name},s.id)),e.jsx(d,{value:"manual",children:"Enter Manually"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"onsite_contact",className:"text-left",children:"Contact Name"}),e.jsx(i,{id:"onsite_contact",name:"onsite_contact",value:l.onsite_contact,onChange:m,className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"onsite_number",className:"text-left",children:"Contact Number"}),e.jsx(i,{id:"onsite_number",name:"onsite_number",value:l.onsite_number,onChange:m,className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"onsite_email",className:"text-left",children:"Contact Email"}),e.jsx(i,{id:"onsite_email",name:"onsite_email",value:l.onsite_email,onChange:m,className:"col-span-3"})]})]}),e.jsx(k,{children:e.jsx(q,{onClick:b,children:"Save changes"})})]})})}export{te as default};
