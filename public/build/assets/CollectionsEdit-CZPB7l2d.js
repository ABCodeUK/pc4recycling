import{r as f,j as e,h as P,b as G}from"./app-DGedXpK6.js";import{S as K,A as Q,a as U,b as W,B as X,c as Y,d as b,e as N,f as T}from"./breadcrumb-DVHq5Awm.js";import{S as m}from"./separator-Qg1edzKM.js";import{B as y}from"./button-DjXm1grC.js";import{I as r}from"./input-CkBA5yRJ.js";import{L as n}from"./label-Ct80BZdK.js";import{S as g,a as p,b as j,c as u,d as o}from"./select-DuTKz2sq.js";import{t as v}from"./index-B34HRg7w.js";import{A as Z,a as ee,b as se,c as ie,d as ne,e as le,f as ae,g as ce,h as de}from"./alert-dialog-FwAlGMcx.js";import{A as te}from"./arrow-left-DY8IiIyw.js";import{S as re}from"./save-DAP7lMw6.js";import{T as oe}from"./trash-2-CE_77rkt.js";import"./index-Dx4p5O6H.js";import"./index-BOJ2gww-.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./index-D1brpkaJ.js";import"./createLucideIcon-C-iaKTyE.js";import"./index-BNfd2_2U.js";import"./index-CLFtQT3G.js";import"./index-Crf3phMa.js";import"./index-B_qNjpXx.js";import"./index-CvV_Mgk0.js";import"./index-DYpMfZUf.js";function Be({job:a,customers:S,addresses:w,collection_types:B,sanitisation_options:V,status_options:M,staff_members:C,sub_clients:A}){var k,E,q,L;const[I,F]=f.useState(!1),O=()=>{F(!0),P.delete(`/collections/${a.id}`,{onSuccess:()=>{v.success("Job successfully deleted!"),P.get("/collections")},onError:()=>{v.error("Failed to delete job. Please try again."),F(!1)}})},[c,h]=f.useState({job_id:a.job_id||"",client_id:((k=a.client_id)==null?void 0:k.toString())||"",collection_date:a.collection_date?new Date(a.collection_date).toISOString().split("T")[0]:"",job_status:a.job_status||"",staff_collecting:a.staff_collecting||"",vehicle:a.vehicle||"",address:a.address||"",address_2:a.address_2||"",town_city:a.town_city||"",postcode:a.postcode||"",onsite_contact:a.onsite_contact||"",onsite_number:a.onsite_number||"",onsite_email:a.onsite_email||"",collection_type:((E=a.collection_type)==null?void 0:E.toString())||"",data_sanitisation:a.data_sanitisation||"",sla:a.sla||"",instructions:a.instructions||"",equipment_location:a.equipment_location||"",building_access:a.building_access||"",collection_route:a.collection_route||"",parking_loading:a.parking_loading||"",equipment_readiness:a.equipment_readiness||""}),[J,D]=f.useState(!1),t=s=>{const{name:d,value:l}=s.target;h(x=>({...x,[d]:l}))},_=(s,d)=>{h(l=>({...l,[s]:d}))},R=s=>{if(s==="manual"){h(l=>({...l,staff_collecting:""}));return}const d=C.find(l=>l.id.toString()===s);d&&h(l=>({...l,staff_collecting:d.name}))},$=s=>{if(s==="manual"){h(l=>({...l,address:"",address_2:"",town_city:"",county:"",postcode:""}));return}if(s==="main"){i&&h(l=>({...l,address:i.address||"",address_2:i.address_2||"",town_city:i.town_city||"",county:i.county||"",postcode:i.postcode||""}));return}const d=w.find(l=>l.id.toString()===s);d&&h(l=>({...l,address:d.address,address_2:d.address_2,town_city:d.town_city,county:d.county||"",postcode:d.postcode}))},H=s=>{if(s==="manual"){h(l=>({...l,onsite_contact:"",onsite_number:"",onsite_email:""}));return}if(s==="main"&&i){h(l=>({...l,onsite_contact:i.contact_name||"",onsite_number:i.mobile||i.landline||"",onsite_email:i.email||""}));return}const d=A.find(l=>l.id.toString()===s);d&&h(l=>({...l,onsite_contact:d.name,onsite_number:d.mobile||d.landline||"",onsite_email:d.email}))},z=async()=>{var s,d,l;try{D(!0);const x={...c,collection_type:c.collection_type?parseInt(c.collection_type):null};(await G.put(`/collections/${a.id}`,x)).status===200?v.success("Changes saved successfully!"):v.error("Failed to save changes. Please try again.")}catch(x){console.error("Save error:",((s=x.response)==null?void 0:s.data)||x),v.error(((l=(d=x.response)==null?void 0:d.data)==null?void 0:l.message)||"An error occurred while saving changes.")}finally{D(!1)}},i=S.find(s=>s.id.toString()===c.client_id);return e.jsxs(K,{children:[e.jsx(Q,{}),e.jsxs(U,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 bg-white border-b",children:[e.jsx(W,{className:"-ml-1"}),e.jsx(m,{orientation:"vertical",className:"h-4 mx-2"}),e.jsx(X,{children:e.jsxs(Y,{children:[e.jsx(b,{children:e.jsx(N,{href:"/dashboard",children:"Dashboard"})}),e.jsx(T,{}),e.jsx(b,{children:e.jsx(N,{href:"/collections",children:"Collections"})}),e.jsx(T,{}),e.jsx(b,{children:e.jsx(N,{href:"#",children:"Edit Job"})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-3xl font-semibold text-gray-800",children:["Collection: ",a.job_id]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(y,{variant:"outline",onClick:()=>window.location.href=`/collections/${a.id}`,children:[e.jsx(te,{className:"h-6 w-6"}),"Done Editing"]}),e.jsxs(y,{className:"bg-green-500 text-white hover:bg-green-600 focus:ring-2 focus:ring-green-400",onClick:z,disabled:J,children:[e.jsx(re,{className:"h-6 w-6"}),"Save Changes"]}),e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsxs(y,{className:"bg-red-500 text-white hover:bg-red-600 focus:ring-2 focus:ring-red-400",disabled:I,children:[e.jsx(oe,{className:"h-6 w-6"}),"Delete Job"]})}),e.jsxs(se,{children:[e.jsxs(ie,{children:[e.jsx(ne,{children:"Confirm Deletion"}),e.jsx(le,{children:"Are you sure you want to delete this job? This action cannot be undone."})]}),e.jsxs(ae,{children:[e.jsx(ce,{children:"Cancel"}),e.jsx(de,{onClick:O,children:"Delete"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("section",{className:"bg-white border shadow rounded-lg",children:[e.jsx("header",{className:"p-6",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Collection Details"})}),e.jsx(m,{}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"job_id",children:"Job Number*"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"job_id",name:"job_id",value:c.job_id,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"client_id",children:"Customer*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{value:c.client_id,onValueChange:s=>_("client_id",s),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Select Customer"})}),e.jsx(u,{children:S.map(s=>e.jsx(o,{value:s.id.toString(),children:s.company_name||s.name},s.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"job_status",children:"Status*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{value:c.job_status,onValueChange:s=>_("job_status",s),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Select Status"})}),e.jsx(u,{children:M.map(s=>e.jsx(o,{value:s,children:s},s))})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"collection_date",children:"Collection Date"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"collection_date",name:"collection_date",type:"date",value:c.collection_date,onChange:t})})]})]}),e.jsx(m,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"staff_select",children:"Staff Collecting"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{onValueChange:R,children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Enter Manually"})}),e.jsxs(u,{children:[e.jsx(o,{value:"manual",children:"Enter Manually"}),C.map(s=>e.jsx(o,{value:s.id.toString(),children:s.name},s.id))]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"staff_collecting",children:"Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"staff_collecting",name:"staff_collecting",value:c.staff_collecting,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"vehicle",children:"Vehicle"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"vehicle",name:"vehicle",value:c.vehicle,onChange:t})})]})]}),e.jsx(m,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"collection_address",children:"Collection Address"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{onValueChange:$,children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Enter Manually"})}),e.jsxs(u,{children:[e.jsx(o,{value:"manual",children:"Enter Manually"}),i&&i.address&&e.jsxs(o,{value:"main",children:[i.address,", ",i.address_2,", ",i.town_city,", ",i.postcode," (Account Address)"]}),w.map(s=>e.jsxs(o,{value:s.id.toString(),children:[s.address,", ",s.address_2,", ",s.town_city,", ",s.postcode]},s.id))]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"address",children:"Address Line 1"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"address",name:"address",value:c.address,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"address_2",children:"Address Line 2"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"address_2",name:"address_2",value:c.address_2,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"town_city",children:"Town/City"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"town_city",name:"town_city",value:c.town_city,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"county",children:"County"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"county",name:"county",value:c.county||"",onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"postcode",children:"Postcode"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"postcode",name:"postcode",value:c.postcode,onChange:t})})]})]}),e.jsx(m,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"onsite_contact_select",children:"Onsite Contact"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{onValueChange:H,children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Enter Manually"})}),e.jsxs(u,{children:[e.jsx(o,{value:"manual",children:"Enter Manually"}),i&&i.contact_name&&e.jsxs(o,{value:"main",children:[i.contact_name," (Main Contact)"]}),A.map(s=>e.jsx(o,{value:s.id.toString(),children:s.name},s.id))]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"onsite_contact",children:"Onsite Contact Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"onsite_contact",name:"onsite_contact",value:c.onsite_contact,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"onsite_number",children:"Onsite Contact Number"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"onsite_number",name:"onsite_number",value:c.onsite_number,onChange:t})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"onsite_email",children:"Onsite Contact Email"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"onsite_email",name:"onsite_email",type:"email",value:c.onsite_email,onChange:t})})]}),e.jsx(m,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"collection_type",children:"Collection Type*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{value:((q=c.collection_type)==null?void 0:q.toString())||"",onValueChange:s=>_("collection_type",s),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Select Collection Type"})}),e.jsx(u,{children:B.map(s=>e.jsx(o,{value:s.id.toString(),children:s.colt_name},s.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"data_sanitisation",children:"Data Sanitisation*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(g,{value:((L=c.data_sanitisation)==null?void 0:L.toString())||"",onValueChange:s=>_("data_sanitisation",s),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Select Data Sanitisation"})}),e.jsx(u,{children:V.map(s=>e.jsx(o,{value:s.id.toString(),children:s.ds_name},s.id))})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"sla",children:"Service Level Agreement"}),e.jsx("div",{className:"col-span-2",children:e.jsx(r,{id:"sla",name:"sla",value:c.sla,onChange:t})})]})]})]})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg self-start",children:[e.jsxs("div",{className:"flex items-center justify-between p-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Customer Details"}),e.jsxs("div",{className:"text-sm",children:["Account Status: ",e.jsx("span",{className:"text-green-500",children:"Active"})]})]}),e.jsx("hr",{className:"my-0"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Company Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.company_name)||(i==null?void 0:i.name)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Address Line 1"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.address)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Address Line 2"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.address_2)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Town/City"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.town_city)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"County"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.county)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Postcode"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.postcode)||"-"})})]})]}),e.jsx(m,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Contact Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.contact_name)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Position"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.position)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Landline"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.landline)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Mobile"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.mobile)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{children:"Email"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(i==null?void 0:i.email)||"-"})})]}),e.jsx(m,{}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"equipment_location",children:"Equipment Location"}),e.jsx("textarea",{id:"equipment_location",name:"equipment_location",rows:4,placeholder:"Please enter any notes about Equipment Location here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:c.equipment_location,onChange:t})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"building_access",children:"Building Access"}),e.jsx("textarea",{id:"building_access",name:"building_access",rows:4,placeholder:"Please enter any notes about Building Access here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:c.building_access,onChange:t})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"collection_route",children:"Collection Route"}),e.jsx("textarea",{id:"collection_route",name:"collection_route",rows:4,placeholder:"Please enter any notes about this job here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:c.collection_route,onChange:t})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"collection_route",children:"Parking & Loading"}),e.jsx("textarea",{id:"parking_loading",name:"parking_loading",rows:4,placeholder:"Please enter any notes about Parking & Loading here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:c.parking_loading,onChange:t})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"equipment_readiness",children:"Equipment Readiness"}),e.jsx("textarea",{id:"equipment_readiness",name:"equipment_readiness",rows:4,placeholder:"Please enter any notes about Equipment Readiness here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:c.equipment_readiness,onChange:t})]}),e.jsx(m,{}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"collection_route",children:"Other Information"}),e.jsx("textarea",{id:"instructions",name:"instructions",rows:4,placeholder:"Please enter any notes about this job here...",className:"w-full min-h-[80px] rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:c.instructions,onChange:t})]})]})]})]})]})]})]})]})}export{Be as default};
