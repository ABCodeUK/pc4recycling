import{r as l,j as e,b as j}from"./app-CxxjQbGd.js";import{S as H}from"./separator-OWjsBv_k.js";import{B as o}from"./button-BfCUFj2v.js";import{I as u}from"./input-DPP4pqCX.js";import{L as C}from"./label-2wttpgDy.js";import{DataTable as M}from"./data-table-DunlG8C3.js";import{subCategoryColumns as P}from"./columns-RM8vEUDH.js";import{D as A,b as _,c as E,d as k,e as F,f as T}from"./dialog-0RdKrRPh.js";import{A as R,a as U,b as G,c as J,d as K,e as Q,f as V,g as X,h as Y}from"./alert-dialog-IHHWyKpT.js";import{t as d}from"./index-CGbDflUn.js";import{S as Z}from"./square-pen-DlkBvHz6.js";import{T as ee}from"./trash-2-BuUhqBcA.js";import"./index-Drt13xjj.js";import"./index-DdQz_MXT.js";import"./index-B6zYnIfL.js";import"./utils-CytzSlOG.js";import"./index-BwobEAja.js";import"./table-B3GsT3Yk.js";import"./select-CnJHFvlZ.js";import"./index-CpwjmW8Z.js";import"./Combination-DnQhWoyI.js";import"./createLucideIcon-YMZQpf5O.js";import"./index-uXkLkjFM.js";import"./index-Dy7fGhxC.js";function De({parentId:b}){const[S,g]=l.useState([]),[c,N]=l.useState({name:"",default_weight:""}),[r,D]=l.useState(null),[i,h]=l.useState({name:"",default_weight:""}),[v,L]=l.useState(""),[O,x]=l.useState(!1),[q,f]=l.useState(!1);l.useEffect(()=>{(async()=>{try{const t=await j.get(`/sub-categories/${b}`);g(t.data)}catch{d.error("Failed to fetch subcategories.")}})()},[b]);const w=()=>h({name:"",default_weight:""}),y=()=>{N({name:"",default_weight:""}),w()},p=(s,t)=>{const{name:a,value:n}=s.target;t==="add"?N(m=>({...m,[a]:n})):r&&D(m=>m?{...m,[a]:n}:null),h(m=>({...m,[a]:""}))},I=async()=>{var t;if(w(),S.some(a=>a.name.toLowerCase()===c.name.toLowerCase())){h(a=>({...a,name:"This name is already in use."}));return}try{const a=await j.post("/sub-categories",{...c,parent_id:b});g(n=>[...n,a.data]),x(!1),y(),d.success("SubCategory successfully created!")}catch(a){(t=a.response)!=null&&t.data.errors?h(a.response.data.errors):d.error("Error creating SubCategory.")}},W=async()=>{var s;if(r){w();try{const t=await j.put(`/sub-categories/${r.id}`,r);g(a=>a.map(n=>n.id===r.id?t.data:n)),f(!1),d.success("SubCategory successfully updated!")}catch(t){(s=t.response)!=null&&s.data.errors?h(t.response.data.errors):d.error("Error updating SubCategory.")}}},$=async s=>{try{await j.delete(`/sub-categories/${s}`),g(t=>t.filter(a=>a.id!==s)),d.success("SubCategory successfully deleted!")}catch{d.error("Error deleting SubCategory.")}},z=S.filter(s=>s.name.toLowerCase().includes(v.toLowerCase())),B=[...P.filter(s=>["name","default_weight"].includes(s.id)),{id:"actions",header:"Actions",cell:({row:s})=>e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>{D(s.original),f(!0)},children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsxs(R,{children:[e.jsx(U,{asChild:!0,children:e.jsx(o,{variant:"destructive",size:"sm",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(G,{children:[e.jsxs(J,{children:[e.jsx(K,{children:"Confirm Deletion"}),e.jsxs(Q,{children:["Are you sure you want to delete SubCategory ",e.jsx("b",{children:s.original.name}),"?"]})]}),e.jsxs(V,{children:[e.jsx(X,{children:"Cancel"}),e.jsx(Y,{onClick:()=>$(s.original.id),children:"Delete"})]})]})]})]})}];return e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsxs("header",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"Manage Sub Categories"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, edit, or delete Sub Categories."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(u,{placeholder:"Search Sub Categories...",value:v,onChange:s=>L(s.target.value),className:"max-w-sm"}),e.jsx(o,{onClick:()=>x(!0),children:"Add SubCategory"})]})]}),e.jsx(H,{className:"my-4"}),e.jsx(M,{columns:B,data:z}),e.jsx(A,{open:O,onOpenChange:s=>{s||y(),x(s)},children:e.jsxs(_,{className:"sm:max-w-[425px] bg-white",children:[e.jsxs(E,{children:[e.jsx(k,{children:"Add SubCategory"}),e.jsx(F,{children:"Fill in the details for the new SubCategory below."})]}),e.jsx("div",{className:"bg-white border rounded-lg p-6",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"name",children:"Name"}),e.jsx(u,{id:"name",name:"name",value:c.name,onChange:s=>p(s,"add")}),i.name&&e.jsx("p",{className:"text-red-600 text-sm",children:i.name})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"default_weight",children:"Default Weight*"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(u,{id:"default_weight",name:"default_weight",type:"number",value:(c==null?void 0:c.default_weight)||"",onChange:s=>p(s,"add"),required:!0,className:"pr-10"}),e.jsx("span",{className:"absolute right-3 text-sm text-gray-500",children:"kg"}),i.default_weight&&e.jsx("p",{className:"text-red-600 text-sm",children:i.default_weight})]})]})]})}),e.jsxs(T,{children:[e.jsx(o,{variant:"outline",onClick:()=>{y(),x(!1)},children:"Cancel"}),e.jsx(o,{onClick:I,children:"Create SubCategory"})]})]})}),e.jsx(A,{open:q,onOpenChange:f,children:e.jsxs(_,{className:"sm:max-w-[425px] bg-white",children:[e.jsxs(E,{children:[e.jsx(k,{children:"Edit SubCategory"}),e.jsx(F,{children:"Update the details for the SubCategory below."})]}),e.jsx("div",{className:"bg-white border rounded-lg p-6",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"name",children:"Name"}),e.jsx(u,{id:"name",name:"name",value:(r==null?void 0:r.name)||"",onChange:s=>p(s,"edit")}),i.name&&e.jsx("p",{className:"text-red-600 text-sm",children:i.name})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"default_weight",children:"Default Weight*"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(u,{id:"default_weight",name:"default_weight",type:"number",value:(r==null?void 0:r.default_weight)||"",onChange:s=>p(s,"edit"),required:!0,className:"pr-10"}),e.jsx("span",{className:"absolute right-3 text-sm text-gray-500",children:"kg"}),i.default_weight&&e.jsx("p",{className:"text-red-600 text-sm",children:i.default_weight})]})]})]})}),e.jsxs(T,{children:[e.jsx(o,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(o,{onClick:W,children:"Save Changes"})]})]})})]})}export{De as default};
