import{r as k,j as e,b as B,h as C}from"./app-CxxjQbGd.js";import{S as L,A as T,a as M,b as $,B as E,c as H,d as u,e as y,f as z}from"./breadcrumb-CVfpatPu.js";import{S as r}from"./separator-OWjsBv_k.js";import{B as d}from"./button-BfCUFj2v.js";import{L as i}from"./label-2wttpgDy.js";import{I as f}from"./input-DPP4pqCX.js";import{t as v}from"./index-CGbDflUn.js";import{c as S}from"./createLucideIcon-YMZQpf5O.js";import{A as I}from"./arrow-left-BksZfyPd.js";import{S as J}from"./square-pen-DlkBvHz6.js";import{T as _}from"./trash-2-BuUhqBcA.js";import"./index-B6zYnIfL.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./index-uXkLkjFM.js";import"./index-CpwjmW8Z.js";import"./Combination-DnQhWoyI.js";import"./index-Drt13xjj.js";import"./index-DdQz_MXT.js";import"./index-Dy7fGhxC.js";import"./index-BlL_lDRx.js";import"./index---YqbKSt.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=S("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=S("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function re({job:c,customers:D,documents:F}){const[l,p]=k.useState(F||{collection_manifest:null,hazard_waste_note:null,data_destruction_certificate:null,other:[]}),[x,b]=k.useState({collection_manifest:null,hazard_waste_note:null,data_destruction_certificate:null,other:null}),m=async a=>{const h=x[a];if(!h)return;const n=new FormData;n.append("document",h),n.append("document_type",a);try{const t=await B.post(`/collections/${c.id}/documents`,n,{headers:{"Content-Type":"multipart/form-data"}});t.data&&(p(a==="other"?o=>({...o,other:[...o.other,t.data.document]}):o=>({...o,[a]:t.data.document})),b(o=>({...o,[a]:null})),v.success("Document uploaded successfully"))}catch(t){console.error("Upload error:",t),v.error("Failed to upload document")}},g=(a,h)=>{var t;const n=(t=a.target.files)==null?void 0:t[0];n&&b(o=>({...o,[h]:n}))};d,x.collection_manifest;const N=(a,h)=>{C.delete(`/collections/${c.id}/documents/${a}`,{preserveScroll:!0,onSuccess:()=>{p(h==="other"?n=>({...n,other:n.other.filter(t=>t.id!==a)}):n=>({...n,[h]:null})),v.success("Document deleted successfully")},onError:()=>{v.error("Failed to delete document")}})},s=D.find(a=>a.id===c.client_id),A=c.collection_date?new Date(c.collection_date).toLocaleDateString():"-";return e.jsxs(L,{children:[e.jsx(T,{}),e.jsxs(M,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 bg-white border-b",children:[e.jsx($,{className:"-ml-1"}),e.jsx(r,{orientation:"vertical",className:"h-4 mx-2"}),e.jsx(E,{children:e.jsxs(H,{children:[e.jsx(u,{children:e.jsx(y,{href:"/dashboard",children:"Dashboard"})}),e.jsx(z,{}),e.jsx(u,{children:e.jsx(y,{href:"/collections",children:"Collections"})}),e.jsx(z,{}),e.jsx(u,{children:e.jsx(y,{href:"#",children:"View Job"})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-3xl font-semibold text-gray-800",children:["Collection: ",c.job_id]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(d,{variant:"outline",onClick:()=>window.location.href="/collections",children:[e.jsx(I,{className:"h-6 w-6"}),"Back to Collections"]}),e.jsxs(d,{onClick:()=>window.location.href=`/collections/${c.id}/edit`,children:[e.jsx(J,{className:"h-6 w-6"}),"Edit Job"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("section",{className:"bg-white border shadow rounded-lg",children:[e.jsx("header",{className:"p-6",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Collection Details"})}),e.jsx(r,{}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Job Number"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.job_id})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Customer"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.company_name)||(s==null?void 0:s.name)})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Collection Date"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:A})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Status"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.job_status})})]})]}),e.jsx(r,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Staff Collecting"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.staff_collecting||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Vehicle"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.vehicle||"-"})})]})]}),e.jsx(r,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Address"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.address})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Town/City"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.town_city})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Postcode"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.postcode})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Onsite Contact"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.onsite_contact||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Onsite Number"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.onsite_number||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Onsite Email"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.onsite_email||"-"})})]})]}),e.jsx(r,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Collection Type"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.collection_type})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Data Sanitisation"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.data_sanitisation})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Service Level Agreement"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:c.sla||"-"})})]})]})]})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg self-start",children:[e.jsxs("div",{className:"flex items-center justify-between p-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Customer Details"}),e.jsxs("div",{className:"text-sm",children:["Account Status: ",e.jsx("span",{className:"text-green-500",children:"Active"})]})]}),e.jsx(r,{}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Company Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.company_name)||(s==null?void 0:s.name)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Address"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.address)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Town/City"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.town_city)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"County"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.county)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Postcode"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.postcode)||"-"})})]})]}),e.jsx(r,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Contact Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.contact_name)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Position"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.position)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Landline"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.landline)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Mobile"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.mobile)||"-"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(i,{children:"Email"}),e.jsx("div",{className:"col-span-2",children:e.jsx("p",{children:(s==null?void 0:s.email)||"-"})})]}),e.jsx(r,{}),e.jsxs("div",{children:[e.jsx(i,{children:"Job Instructions"}),e.jsx("div",{className:"mt-2 whitespace-pre-wrap rounded-md border border-input bg-background px-3 py-2 text-sm",children:c.instructions||"No instructions provided."})]})]})]})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg",children:[e.jsx("header",{className:"p-6",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Job Documents"})}),e.jsx(r,{}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium",children:"Collection Manifest"}),e.jsx("div",{className:"flex gap-2 items-center",children:l.collection_manifest?e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:`/storage/${l.collection_manifest.file_path}`,target:"_blank",className:"text-blue-600 hover:underline flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),l.collection_manifest.original_filename]}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>l.collection_manifest&&N(l.collection_manifest.id,"collection_manifest"),children:e.jsx(_,{className:"h-4 w-4 text-red-500"})})]}):e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(f,{type:"file",accept:".pdf",onChange:a=>g(a,"collection_manifest")}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>m("collection_manifest"),disabled:!x.collection_manifest,children:e.jsx(j,{className:"h-4 w-4"})})]})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium",children:"Hazard Waste Note"}),e.jsx("div",{className:"flex gap-2 items-center",children:l.hazard_waste_note?e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:`/storage/${l.hazard_waste_note.file_path}`,target:"_blank",className:"text-blue-600 hover:underline flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),l.hazard_waste_note.original_filename]}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>l.hazard_waste_note&&N(l.hazard_waste_note.id,"hazard_waste_note"),children:e.jsx(_,{className:"h-4 w-4 text-red-500"})})]}):e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(f,{type:"file",accept:".pdf",onChange:a=>g(a,"hazard_waste_note")}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>m("hazard_waste_note"),disabled:!x.hazard_waste_note,children:e.jsx(j,{className:"h-4 w-4"})})]})})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium",children:"Data Destruction Certificate"}),e.jsx("div",{className:"flex gap-2 items-center",children:l.data_destruction_certificate?e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:`/storage/${l.data_destruction_certificate.file_path}`,target:"_blank",className:"text-blue-600 hover:underline flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),l.data_destruction_certificate.original_filename]}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>l.data_destruction_certificate&&N(l.data_destruction_certificate.id,"data_destruction_certificate"),children:e.jsx(_,{className:"h-4 w-4 text-red-500"})})]}):e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(f,{type:"file",accept:".pdf",onChange:a=>g(a,"data_destruction_certificate")}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>m("data_destruction_certificate"),disabled:!x.data_destruction_certificate,children:e.jsx(j,{className:"h-4 w-4"})})]})})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium",children:"Other Documents"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(f,{type:"file",accept:".pdf",onChange:a=>g(a,"other")}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>m("other"),disabled:!x.other,children:e.jsx(j,{className:"h-4 w-4"})})]}),l.other.length>0&&e.jsx("div",{className:"space-y-2",children:l.other.map(a=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsxs("a",{href:`/storage/${a.file_path}`,target:"_blank",className:"text-blue-600 hover:underline flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),a.original_filename]}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>N(a.id,"other"),children:e.jsx(_,{className:"h-4 w-4 text-red-500"})})]},a.id))})]})]})]})]})]})]})]})]})}export{re as default};
