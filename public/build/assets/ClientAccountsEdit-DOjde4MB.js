import{j as e,r as v,b as w}from"./app-CNWjOMNx.js";import{S as ae,A as re,a as te,b as ie,B as le,c as ne,d as P,e as A,f as R}from"./breadcrumb-BRBq9mE3.js";import{S as m}from"./separator-BPue9knr.js";import{B as f}from"./button-Cif8vmUM.js";import{I as l}from"./input-CKARXW-H.js";import ce from"./ClientAddresses-BtBG1PsJ.js";import{L as t}from"./label-EHUiVpis.js";import{S as y,a as b,b as C,c as S,d as u}from"./select-DyBRev3z.js";import{S as $}from"./switch-3WLVaHNX.js";import{A as M,a as V,b as O,c as q,d as J,e as Y,f as H,g as U,h as z}from"./alert-dialog-BBmyk8cd.js";import{t as n}from"./index-DROTMuiR.js";import oe from"./ClientJobs-C-ugtPFZ.js";import de from"./ClientSubClients-CbX3GzKy.js";import{A as me}from"./arrow-left-BoyVnRRs.js";import{S as he}from"./save-D9Hk0G5B.js";import{T as xe}from"./trash-2-UOQr6mTH.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./dialog-BfgzRhkV.js";import"./index-D-4-NTWd.js";import"./index-DPKFiV9N.js";import"./index-CnljWFNF.js";import"./index-BHpFse_T.js";import"./index-DUDCROMg.js";import"./index-BJMVI5o3.js";import"./createLucideIcon-ClQ1hqbp.js";import"./index-CmDO7QdU.js";import"./index-CNsmnkFI.js";import"./index-BqYSSVB3.js";import"./index-D0kbjZ6r.js";import"./calendar-BUGi4wxL.js";import"./data-table-BHvwIO4S.js";import"./table-B5rCecqS.js";import"./columns-DXhuHmbw.js";import"./square-pen-DthIdKap.js";import"./index-BflIAMo0.js";import"./data-table-BciyoiUe.js";import"./columns-B0G-6a2i.js";import"./badge-BpDmfbip.js";import"./arrow-up-down-B8GbFRXv.js";import"./user-wgCuhKwY.js";import"./eye-B3TLv2b1.js";import"./data-table-CS4mL3vy.js";import"./columns-CGpuc818.js";function ts({user_edit:i,client_details:c,customer_types:F,industries:D,lead_sources:G}){if(!i||!c||!F||!D)return e.jsx("div",{children:"Loading..."});const[a,j]=v.useState({name:i.name||"",email:i.email||"",position:c.contact_position||"",landline:i.landline||"",mobile:i.mobile||"",contract:i.contract||"",active:i.active||!1,sustainability:i.sustainability==="1",type:"client",address:c.address||"",address_2:c.address_2||"",town_city:c.town_city||"",county:c.county||"",postcode:c.postcode||"",contact_name:c.contact_name||"",sic_code:c.sic_code||"",customer_notes:c.customer_notes||"",customer_type_id:String(c.customer_type_id)||"",industry_id:String(c.industry_id)||"",lead_source_id:String(c.lead_source_id)||""}),[g,_]=v.useState({newPassword:"",confirmPassword:""}),[N,E]=v.useState({name:"",email:""}),[I,L]=v.useState(!1),k=()=>E({name:"",email:""}),o=s=>{const{name:r,value:d}=s.target;j(h=>({...h,[r]:d})),k()},K=s=>{j(r=>({...r,active:s}))},Q=async s=>{var r,d,h,p,T;s.preventDefault(),k();try{L(!0);const x={...a,sustainability:a.sustainability?1:0,type:"Client",position:a.position||null,customer_type_id:a.customer_type_id==="null"?null:a.customer_type_id,industry_id:a.industry_id==="null"?null:a.industry_id,lead_source_id:a.lead_source_id==="null"?null:a.lead_source_id,active:!!a.active};console.log("Sending payload:",x),(await w.put(`/customers/update/${i.id}`,x)).status===200&&(n.success("Client successfully updated!"),window.location.reload())}catch(x){if(console.error("Update error:",(r=x.response)==null?void 0:r.data),(h=(d=x.response)==null?void 0:d.data)!=null&&h.errors){const B=x.response.data.errors;Object.entries(B).forEach(([ee,se])=>{n.error(`${ee}: ${se}`)}),E(x.response.data.errors)}else(T=(p=x.response)==null?void 0:p.data)!=null&&T.message?n.error(x.response.data.message):n.error("An error occurred while updating the client.")}finally{L(!1)}},W=async()=>{var s,r,d,h;try{(await w.delete(`/customers/delete/${i.id}`)).status===200&&(n.success("Client account successfully deleted!"),window.location.href="/customers")}catch(p){(r=(s=p.response)==null?void 0:s.data)!=null&&r.hasJobs?n.error(p.response.data.message):n.error(((h=(d=p.response)==null?void 0:d.data)==null?void 0:h.message)||"An error occurred while deleting the account.")}},X=async()=>{try{(await w.post(`/customers/${i.id}/send-reset-email`)).status===200?n.success("Password reset email sent successfully."):n.error("Failed to send password reset email.")}catch{n.error("An error occurred while sending the password reset email.")}},Z=async()=>{var s,r;if(g.newPassword!==g.confirmPassword){n.error("Passwords do not match.");return}try{await w.post(`/customers/${i.id}/reset-password`,{password:g.newPassword,password_confirmation:g.confirmPassword}),n.success("Password reset successfully."),_({newPassword:"",confirmPassword:""})}catch(d){(r=(s=d.response)==null?void 0:s.data)!=null&&r.errors?Object.values(d.response.data.errors).forEach(h=>{n.error(h[0])}):n.error("An error occurred while resetting the password.")}};return e.jsxs(ae,{children:[e.jsx(re,{}),e.jsxs(te,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 bg-white border-b",children:[e.jsx(ie,{className:"-ml-1"}),e.jsx(m,{orientation:"vertical",className:"h-4 mx-2"}),e.jsx(le,{children:e.jsxs(ne,{children:[e.jsx(P,{children:e.jsx(A,{href:"/",children:"Dashboard"})}),e.jsx(R,{}),e.jsx(P,{children:e.jsx(A,{href:"/customers",children:"Customers"})}),e.jsx(R,{}),e.jsx(P,{children:e.jsx(A,{href:"#",children:"Edit Customer"})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-3xl font-semibold text-gray-800",children:"Settings: Edit Customer Account"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(f,{variant:"outline",onClick:()=>window.location.href=`/customers/${i.id}`,children:[e.jsx(me,{className:"h-6 w-6 mr-0"}),"Done Editing"]}),e.jsx(f,{className:"bg-green-500 text-white hover:bg-green-600 focus:ring-2 focus:ring-green-400",onClick:Q,disabled:I,children:I?e.jsx("span",{children:"Saving..."}):e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"h-5 w-5"}),"Save Changes"]})})]})]}),e.jsxs("div",{className:"flex flex-col gap-6 p-0",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold leading-7 text-gray-900 flex justify-between items-center",children:["Customer Details",e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Account Status:"}),e.jsx("span",{className:`text-sm px-4 py-1 rounded-sm ${a.active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"} font-medium`,children:a.active?"Active":"Disabled"})]})]}),e.jsx(m,{className:"my-4"}),e.jsxs("div",{className:"grid gap-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"name",className:"text-left",children:"Company Name*"}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(l,{id:"name",name:"name",value:a.name,onChange:o,required:!0}),N.name&&e.jsx("p",{className:"text-red-600 text-sm",children:N.name})]})]}),e.jsx(m,{}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"address",className:"text-left",children:"Address Line 1"}),e.jsx("div",{className:"col-span-2",children:e.jsx(l,{id:"address",name:"address",value:a.address,onChange:o})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"address_2",className:"text-left",children:"Address Line 2"}),e.jsx("div",{className:"col-span-2",children:e.jsx(l,{id:"address_2",name:"address_2",value:a.address_2,onChange:o})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"town_city",className:"text-left",children:"Town/City"}),e.jsx("div",{className:"col-span-2",children:e.jsx(l,{id:"town_city",name:"town_city",value:a.town_city,onChange:o})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"county",className:"text-left",children:"County"}),e.jsx("div",{className:"col-span-2",children:e.jsx(l,{id:"county",name:"county",value:a.county,onChange:o})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"postcode",className:"text-left",children:"Postcode"}),e.jsx("div",{className:"col-span-2",children:e.jsx(l,{id:"postcode",name:"postcode",value:a.postcode,onChange:o})})]}),e.jsx(m,{}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"contact_name",className:"text-left",children:"Contact Name"}),e.jsx("div",{className:"col-span-2",children:e.jsx(l,{id:"contact_name",name:"contact_name",value:a.contact_name,onChange:o})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"position",className:"text-left",children:"Position"}),e.jsx("div",{className:"col-span-2",children:e.jsx(l,{id:"position",name:"position",value:a.position,onChange:o})})]}),e.jsx(m,{}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"landline",className:"text-left",children:"Landline"}),e.jsx("div",{className:"col-span-2",children:e.jsx(l,{id:"landline",name:"landline",value:a.landline,onChange:o})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"mobile",className:"text-left",children:"Mobile"}),e.jsx("div",{className:"col-span-2",children:e.jsx(l,{id:"mobile",name:"mobile",value:a.mobile,onChange:o})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"email",className:"text-left",children:"Email*"}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(l,{id:"email",name:"email",type:"email",value:a.email,onChange:o,required:!0}),N.email&&e.jsx("p",{className:"text-red-600 text-sm",children:N.email})]})]})]})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"More Details"}),e.jsx(m,{}),e.jsxs("div",{className:"grid gap-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"customer_type_id",className:"text-left",children:"Contract"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(y,{onValueChange:s=>j(r=>({...r,contract:s==="null"?"":s})),value:a.contract||"null",children:[e.jsx(b,{className:"w-full",children:e.jsx(C,{placeholder:"Select Contract Status"})}),e.jsxs(S,{children:[e.jsx(u,{value:"NO",children:"No"}),e.jsx(u,{value:"YES",children:"Yes"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"customer_type_id",className:"text-left",children:"Customer Type"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(y,{onValueChange:s=>j(r=>({...r,customer_type_id:s==="null"?"":s})),value:a.customer_type_id||"null",children:[e.jsx(b,{className:"w-full",children:e.jsx(C,{placeholder:"Select Customer Type"})}),e.jsxs(S,{children:[e.jsx(u,{value:"null",children:"None"}),F.map(s=>e.jsx(u,{value:String(s.id),children:s.ct_name},s.id))]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"lead_source_id",className:"text-left",children:"Lead Source"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(y,{onValueChange:s=>j(r=>({...r,lead_source_id:s==="null"?"":s})),value:a.lead_source_id||"null",children:[e.jsx(b,{className:"w-full",children:e.jsx(C,{placeholder:"Select Lead Source"})}),e.jsxs(S,{children:[e.jsx(u,{value:"null",children:"None"}),G.map(s=>e.jsx(u,{value:String(s.id),children:s.ls_name},s.id))]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"industry_id",className:"text-left",children:"Industry"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(y,{onValueChange:s=>j(r=>({...r,industry_id:s==="null"?"":s})),value:a.industry_id||"null",children:[e.jsx(b,{className:"w-full",children:e.jsx(C,{placeholder:"Select Industry"})}),e.jsxs(S,{children:[e.jsx(u,{value:"null",children:"None"}),D.map(s=>e.jsx(u,{value:String(s.id),children:s.in_name},s.id))]})]})})]}),e.jsx(m,{}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"sic_code",className:"text-left",children:"SIC Code"}),e.jsx("div",{className:"col-span-2",children:e.jsx(l,{id:"sic_code",name:"sic_code",value:a.sic_code,onChange:o})})]}),e.jsx(m,{}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"customer_notes",className:"text-left",children:"Customer Notes"}),e.jsx("div",{className:"col-span-2",children:e.jsx(l,{id:"customer_notes",name:"customer_notes",value:a.customer_notes,onChange:o})})]}),e.jsx(m,{}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(t,{htmlFor:"sustainability",className:"text-left",children:"Sustainability"}),e.jsx("div",{className:"col-span-2 flex items-center",children:e.jsx($,{id:"sustainability",checked:!!a.sustainability,onCheckedChange:s=>j(r=>({...r,sustainability:s}))})})]})]})]})]}),e.jsxs("section",{children:[e.jsx(oe,{parentId:i.id}),e.jsx("div",{className:"mt-6",children:e.jsx(ce,{parentId:i.id})}),e.jsx("div",{className:"mt-6",children:e.jsx(de,{parentId:i.id})})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"Account Settings"}),e.jsx(m,{className:"mb-6"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("h3",{className:"text-base font-medium",children:"Reset Password"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Reset the client's password."}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx(f,{variant:"outline",onClick:X,children:"Email Password Reset"}),e.jsxs(M,{children:[e.jsx(V,{asChild:!0,children:e.jsx(f,{variant:"outline",children:"Manual Password Reset"})}),e.jsxs(O,{children:[e.jsxs(q,{children:[e.jsx(J,{children:"Manual Password Reset"}),e.jsx(Y,{children:"Enter the new password below to manually reset the client's password."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"newPassword",children:"New Password"}),e.jsx(l,{id:"newPassword",name:"newPassword",type:"password",value:g.newPassword,onChange:s=>_(r=>({...r,newPassword:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(l,{id:"confirmPassword",name:"confirmPassword",type:"password",value:g.confirmPassword,onChange:s=>_(r=>({...r,confirmPassword:s.target.value}))})]})]}),e.jsxs(H,{children:[e.jsx(U,{children:"Cancel"}),e.jsx(z,{onClick:Z,children:"Save"})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("h3",{className:"text-base font-medium",children:"Disable Account"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Disable this client account from being accessed."}),e.jsx($,{className:"mt-4",checked:!a.active,onCheckedChange:s=>K(!s)})]}),e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("h3",{className:"text-base font-medium",children:"Delete Account"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Permanently remove this client account from the system."}),e.jsxs(M,{children:[e.jsx(V,{asChild:!0,children:e.jsxs(f,{variant:"destructive",className:"mt-4",children:[e.jsx(xe,{className:"h-5 w-5 mr-2"}),"Delete Account"]})}),e.jsxs(O,{children:[e.jsxs(q,{children:[e.jsx(J,{children:"Confirm Deletion"}),e.jsx(Y,{children:"Are you sure you want to delete this client account? This action cannot be undone."})]}),e.jsxs(H,{children:[e.jsx(U,{children:"Cancel"}),e.jsx(z,{onClick:W,children:"Confirm"})]})]})]})]})]})]})]})]})]})]})}export{ts as default};
