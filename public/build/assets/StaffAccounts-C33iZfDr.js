import{r,j as e,b as h}from"./app-Bu3c7SRr.js";import{S as I,A as z,a as H,b as M,B as O,c as V,d as f,e as x,f as w}from"./breadcrumb-Bi7r5ojT.js";import{S as v}from"./separator-DeG03c2e.js";import{B as l}from"./button-Bugdv60n.js";import{I as j}from"./input-BVpfwKRE.js";import{L as u}from"./label-e3wTgNA8.js";import{S as $,a as q,b as W,c as G,d as J}from"./select-DIgAzQ0l.js";import{DataTable as K}from"./data-table-v4IM_nqW.js";import{columns as Q}from"./columns-CMdk0Ta5.js";import{D as X,a as Y,b as Z,c as U,d as ee,e as se,f as ae}from"./dialog-ggMMgphc.js";import{A as re,a as te,b as ie,c as le,d as oe,e as ne,f as ce,g as de,h as me}from"./alert-dialog-zcL2trcK.js";import{t}from"./index-3t_yQiYB.js";import{S as he}from"./square-pen-DXuvlyv5.js";import{T as fe}from"./trash-2-DrUuMYvl.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./index-ChGmrCfR.js";import"./createLucideIcon-Bz1iimCp.js";import"./index-SS-33b3l.js";import"./index-DFqYG-k0.js";import"./index-BUVUn23p.js";import"./index-_W5zKMP9.js";import"./index-C7O5j1LF.js";import"./index-DwKaao6N.js";import"./index-s5S9bHjZ.js";import"./index-CAO6zNd6.js";import"./calendar-BRWOvoKA.js";import"./table-CKhMPQAp.js";function $e({staff:N,currentUserId:g}){const[y,p]=r.useState(N),[C,F]=r.useState([]),[n,o]=r.useState({name:"",email:"",role_id:""}),[i,S]=r.useState({name:"",email:"",role_id:""}),[c,T]=r.useState(""),[xe,b]=r.useState(!1),[E,d]=r.useState(!1);r.useEffect(()=>{(async()=>{try{const a=await h.get("/settings/staff/roles");Array.isArray(a.data)?F(a.data):(console.error("Roles API did not return an array."),t.error("Failed to fetch roles. Please contact support."))}catch(a){console.error("Error fetching roles:",a),t.error("Failed to fetch roles. Please try again.")}})()},[]);const A=()=>S({name:"",email:"",role_id:""}),D=()=>{o({name:"",email:"",role_id:""}),A()},P=s=>{T(s.target.value)},k=async()=>{A();try{b(!0);const s=await h.post("/settings/staff/store",n);if(s.status===200){const a=s.data;p(m=>[...m,a]),t.success("Staff member successfully added!"),d(!1)}else t.error("Failed to add staff member. Please try again.")}catch(s){s.response&&s.response.data.errors?S(s.response.data.errors):t.error("Error adding staff member. Please check the logs.")}finally{b(!1)}},B=async s=>{try{(await h.delete(`/settings/staff/delete/${s}`)).status===200?(p(m=>m.filter(_=>_.id!==s)),t.success("Staff member successfully deleted!")):t.error("Failed to delete staff member. Please try again.")}catch{t.error("Error deleting staff member. Please check the logs.")}},L=y.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase())),R=[...Q,{id:"actions",header:()=>e.jsx("div",{className:"text-right",children:"Actions"}),cell:({row:s})=>{const a=s.original;return e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>window.location.href=a.id===g?"/my-account/":`/settings/staff/${a.id}/edit`,children:e.jsx(he,{className:"h-4 w-4"})}),e.jsxs(re,{children:[e.jsx(te,{asChild:!0,children:e.jsx(l,{variant:"destructive",size:"sm",disabled:a.id===g,children:e.jsx(fe,{className:"h-4 w-4"})})}),e.jsxs(ie,{children:[e.jsxs(le,{children:[e.jsx(oe,{children:"Confirm Deletion"}),e.jsxs(ne,{children:["Are you sure you want to delete ",e.jsx("b",{children:a.name}),"?"]})]}),e.jsxs(ce,{children:[e.jsx(de,{children:"Cancel"}),e.jsx(me,{onClick:()=>B(a.id),children:"Delete"})]})]})]})]})}}];return e.jsxs(I,{children:[e.jsx(z,{}),e.jsxs(H,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 bg-white border-b",children:[e.jsx(M,{className:"-ml-1"}),e.jsx(v,{orientation:"vertical",className:"h-4 mx-2"}),e.jsx(O,{children:e.jsxs(V,{children:[e.jsx(f,{children:e.jsx(x,{href:"/",children:"Dashboard"})}),e.jsx(w,{}),e.jsx(f,{children:e.jsx(x,{href:"/settings",children:"Settings"})}),e.jsx(w,{}),e.jsx(f,{children:e.jsx(x,{href:"/settings/staff",children:"Staff Accounts"})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-3xl font-semibold text-gray-800",children:"Settings: Staff Accounts"})}),e.jsx(l,{variant:"outline",onClick:()=>window.location.href="/settings/staff/roles/",children:"Manage Staff Roles"})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Manage Staff Accounts"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, edit, or delete staff accounts used in the system."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(j,{placeholder:"Search Staff...",value:c,onChange:P,className:"max-w-sm"}),e.jsxs(X,{open:E,onOpenChange:s=>{s||D(),d(s)},children:[e.jsx(Y,{asChild:!0,children:e.jsx(l,{children:"Add Staff Account"})}),e.jsxs(Z,{className:"sm:max-w-[425px] bg-white",children:[e.jsxs(U,{children:[e.jsx(ee,{children:"Add Staff Account"}),e.jsx(se,{children:"Fill in the details for the new staff member below."})]}),e.jsx("div",{className:"bg-white border rounded-lg p-6",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",children:"Name"}),e.jsx(j,{id:"name",name:"name",value:n.name,onChange:s=>o(a=>({...a,name:s.target.value}))}),i.name&&e.jsx("p",{className:"text-red-600 text-sm",children:i.name})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"email",children:"Email"}),e.jsx(j,{id:"email",name:"email",value:n.email,onChange:s=>o(a=>({...a,email:s.target.value}))}),i.email&&e.jsx("p",{className:"text-red-600 text-sm",children:i.email})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"role_id",children:"Role"}),e.jsxs($,{onValueChange:s=>o(a=>({...a,role_id:s})),children:[e.jsx(q,{className:"w-full",children:e.jsx(W,{placeholder:"Select a Role"})}),e.jsx(G,{children:C.map(s=>e.jsx(J,{value:String(s.id),children:s.name},s.id))})]}),i.role_id&&e.jsx("p",{className:"text-red-600 text-sm",children:i.role_id})]})]})}),e.jsxs(ae,{children:[e.jsx(l,{variant:"outline",onClick:()=>{D(),d(!1)},children:"Cancel"}),e.jsx(l,{onClick:k,children:"Create Staff"})]})]})]})]})]}),e.jsx(v,{className:"my-4"}),e.jsx(K,{columns:R,data:L})]})]})]})]})}export{$e as default};
