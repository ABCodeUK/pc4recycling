import{j as e,r as g,b as f}from"./app-BB65Mc1n.js";import{S as Q,A as W,a as X,b as Y,B as Z,c as ee,d as j,e as p,f as b}from"./breadcrumb-D6RxqHid.js";import{S as N}from"./separator-BWJbAkR8.js";import{B as m}from"./button-AMd0rht4.js";import{I as c}from"./input-BdsrUm4j.js";import{L as n}from"./label-B29Fbpt8.js";import{S as F,a as E,b as R,c as I,d as S}from"./select-Dp5Udnaz.js";import{S as se}from"./switch-BypnEtTE.js";import{A as T,a as k,b as B,c as L,d as M,e as V,f as $,g as q,h as H}from"./alert-dialog-BkxvyqSV.js";import{t as i}from"./index-BD8g9cTJ.js";import{A as re}from"./arrow-left-Dk30N2JD.js";import{S as ae}from"./save-DRu4wydO.js";import{T as te}from"./trash-2-CyBVRyGm.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./dialog-44kL--cs.js";import"./index-DJRbUwlk.js";import"./index-CwOflKzf.js";import"./index-Bax49BpN.js";import"./index-C6WAMNeG.js";import"./index-BD0Aflgb.js";import"./index-DwCxHBl2.js";import"./createLucideIcon-DhOTYlCm.js";import"./index-d89-VRCp.js";import"./index-C6DuYNlM.js";import"./index--1ygw0mz.js";import"./index-D9Y9XxbS.js";import"./calendar-C06wmWHl.js";import"./index-DbDOfuCE.js";function Te({user_edit:a,roles:u}){var _,D;if(!a)return e.jsx("div",{children:"Loading..."});const[t,h]=g.useState({name:a.name||"",email:a.email||"",mobile:a.mobile||"",position:a.position||"",active:a.active||!1,role_id:String(a.role_id)||"",driver_type:a.driver_type||"",carrier_registration:a.carrier_registration||"",external_vehicle_registration:a.external_vehicle_registration||""}),[o,w]=g.useState({newPassword:"",confirmPassword:""}),[x,y]=g.useState({name:"",email:"",role_id:""}),[P,C]=g.useState(!1),A=()=>y({name:"",email:"",role_id:""}),d=s=>{const{name:r,value:l}=s.target;h(v=>({...v,[r]:l})),A()},O=s=>{h(r=>({...r,active:s}))},U=async()=>{var s,r;A();try{C(!0),(await f.put(`/settings/staff/update/${a.id}`,t)).status===200?i.success("Staff member successfully updated!"):i.error("Failed to update staff member. Please try again.")}catch(l){(r=(s=l.response)==null?void 0:s.data)!=null&&r.errors?y(l.response.data.errors):i.error("An error occurred while updating the staff member.")}finally{C(!1)}},z=async()=>{try{(await f.delete(`/settings/staff/delete/${a.id}`)).status===200?(i.success("Staff account successfully deleted!"),window.location.href="/settings/staff"):i.error("Failed to delete account. Please try again.")}catch{i.error("An error occurred while deleting the account.")}},G=async()=>{try{(await f.post(`/settings/staff/${a.id}/send-reset-email`)).status===200?i.success("Password reset email sent successfully."):i.error("Failed to send password reset email.")}catch{i.error("An error occurred while sending the password reset email.")}},J=async()=>{var s,r;if(o.newPassword!==o.confirmPassword){i.error("Passwords do not match.");return}try{await f.post(`/settings/staff/${a.id}/reset-password`,{password:o.newPassword,password_confirmation:o.confirmPassword}),i.success("Password reset successfully."),w({newPassword:"",confirmPassword:""})}catch(l){if((r=(s=l.response)==null?void 0:s.data)!=null&&r.errors){const v=l.response.data.errors;Object.values(v).forEach(K=>{i.error(K[0])})}else i.error("An error occurred while resetting the password.")}};return e.jsxs(Q,{children:[e.jsx(W,{}),e.jsxs(X,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 bg-white border-b",children:[e.jsx(Y,{className:"-ml-1"}),e.jsx(N,{orientation:"vertical",className:"h-4 mx-2"}),e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(j,{children:e.jsx(p,{href:"/",children:"Dashboard"})}),e.jsx(b,{}),e.jsx(j,{children:e.jsx(p,{href:"/settings",children:"Settings"})}),e.jsx(b,{}),e.jsx(j,{children:e.jsx(p,{href:"/settings/staff",children:"Staff Accounts"})}),e.jsx(b,{}),e.jsx(j,{children:e.jsx(p,{href:"#",children:"Edit Staff Account"})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-3xl font-semibold text-gray-800",children:"Settings: Edit Staff Account"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(m,{variant:"outline",onClick:()=>window.location.href="/settings/staff/",children:[e.jsx(re,{className:"h-6 w-6 mr-0"}),"Done Editing"]}),e.jsx(m,{className:"bg-green-500 text-white hover:bg-green-600 focus:ring-2 focus:ring-green-400",onClick:U,disabled:P,children:P?e.jsx("span",{children:"Saving..."}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-5 w-5"}),"Save Changes"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-start",children:[e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"Staff Details"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Update the personal and professional details of the staff member."}),e.jsx(N,{}),e.jsxs("div",{className:"grid gap-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"name",className:"text-left",children:"Name*"}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(c,{id:"name",name:"name",value:t.name,onChange:d,required:!0}),x.name&&e.jsx("p",{className:"text-red-600 text-sm",children:x.name})]})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"email",className:"text-left",children:"Email*"}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(c,{id:"email",name:"email",type:"email",value:t.email,onChange:d,required:!0}),x.email&&e.jsx("p",{className:"text-red-600 text-sm",children:x.email})]})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"role_id",className:"text-left",children:"Role*"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(F,{onValueChange:s=>h(r=>({...r,role_id:s})),value:t.role_id,children:[e.jsx(E,{className:"w-full",children:e.jsx(R,{placeholder:"Select a Role",children:((_=u.find(s=>String(s.id)===t.role_id))==null?void 0:_.name)||"Select a Role"})}),e.jsx(I,{children:u.map(s=>e.jsx(S,{value:String(s.id),children:s.name},s.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"mobile",className:"text-left",children:"Mobile"}),e.jsx("div",{className:"col-span-2",children:e.jsx(c,{id:"mobile",name:"mobile",value:t.mobile,onChange:d})})]}),t.role_id&&((D=u.find(s=>s.id===parseInt(t.role_id)))==null?void 0:D.name)==="Drivers"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"driver_type",className:"text-left",children:"Driver Type"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(F,{value:t.driver_type,onValueChange:s=>{h(r=>({...r,driver_type:s,carrier_registration:s==="internal"?"":r.carrier_registration,external_vehicle_registration:s==="internal"?"":r.external_vehicle_registration}))},children:[e.jsx(E,{children:e.jsx(R,{placeholder:"Select driver type"})}),e.jsxs(I,{children:[e.jsx(S,{value:"internal",children:"Internal"}),e.jsx(S,{value:"external",children:"External"})]})]})})]}),t.driver_type==="external"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"carrier_registration",className:"text-left",children:"Carrier Registration"}),e.jsx("div",{className:"col-span-2",children:e.jsx(c,{id:"carrier_registration",name:"carrier_registration",value:t.carrier_registration,onChange:d,placeholder:"Enter carrier registration"})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(n,{htmlFor:"external_vehicle_registration",className:"text-left",children:"Vehicle Registration"}),e.jsx("div",{className:"col-span-2",children:e.jsx(c,{id:"external_vehicle_registration",name:"external_vehicle_registration",value:t.external_vehicle_registration,onChange:d,placeholder:"Enter vehicle registration"})})]})]})]})]})]}),e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"Account Settings"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage account access, reset passwords, or delete the account."}),e.jsx(N,{className:"mb-10"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("h3",{className:"text-base font-medium",children:"Reset Password"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Reset the user's password using one of the options below."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(m,{variant:"outline",onClick:G,children:"Email Password Reset"}),e.jsxs(T,{children:[e.jsx(k,{asChild:!0,children:e.jsx(m,{variant:"outline",children:"Manual Password Reset"})}),e.jsxs(B,{children:[e.jsxs(L,{children:[e.jsx(M,{children:"Manual Password Reset"}),e.jsx(V,{children:"Enter the new password below to manually reset the user's password."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"newPassword",children:"New Password"}),e.jsx(c,{id:"newPassword",name:"newPassword",type:"password",value:o.newPassword,onChange:s=>w(r=>({...r,newPassword:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(c,{id:"confirmPassword",name:"confirmPassword",type:"password",value:o.confirmPassword,onChange:s=>w(r=>({...r,confirmPassword:s.target.value}))})]})]}),e.jsxs($,{children:[e.jsx(q,{children:"Cancel"}),e.jsx(H,{onClick:J,children:"Save"})]})]})]})]})]}),e.jsxs("div",{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("h3",{className:"text-base font-medium",children:"Disable Account"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Disable this account from being accessed."})]}),e.jsx(se,{checked:!t.active,onCheckedChange:s=>O(!s)})]}),e.jsxs("div",{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("h3",{className:"text-base font-medium",children:"Delete Account"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Permanently remove this account from the system. This action cannot be undone."})]}),e.jsx("div",{children:e.jsxs(T,{children:[e.jsx(k,{asChild:!0,children:e.jsxs(m,{variant:"destructive",children:[e.jsx(te,{className:"h-5 w-5 mr-2"}),"Delete Account"]})}),e.jsxs(B,{children:[e.jsxs(L,{children:[e.jsx(M,{children:"Confirm Deletion"}),e.jsx(V,{children:"Are you sure you want to delete this account? This action cannot be undone."})]}),e.jsxs($,{children:[e.jsx(q,{children:"Cancel"}),e.jsx(H,{onClick:z,children:"Confirm"})]})]})]})})]})]})]})]}),e.jsx("div",{className:"flex justify-end gap-4 mt-6"})]})]})]})}export{Te as default};
