import{r as m,j as e,b as I}from"./app-DUv4C8zR.js";import{S as le,A as ne,a as de,b as ce,B as oe,c as he,d as $,e as L,f as H}from"./breadcrumb-BeSrBSyR.js";import{S as V}from"./separator-52U-weNF.js";import{B as x}from"./button-ByXYoKeZ.js";import{I as n}from"./input-ER8UZmlu.js";import{L as t}from"./label-Dmu6HX2v.js";import{DataTable as me}from"./data-table-DjPZhNYf.js";import{columns as xe}from"./columns-CtSYfiK-.js";import{D as z,a as pe,b as R,c as U,d as G,e as J,f as K}from"./dialog-BeE9kzvs.js";import{M as C}from"./multiple-select-Cc9MVvHe.js";import{S,a as b,b as w,c as N,d as h}from"./select-Cce2oJH8.js";import{A as ue,a as ge,b as je,c as fe,d as _e,e as ve,f as ye,g as Ce,h as Se}from"./alert-dialog-CJpxWzU0.js";import{t as p}from"./index-DfymCQFU.js";import{S as be}from"./square-pen-D_BQbCxq.js";import{T as we}from"./trash-2-DBI7At-f.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./index-B9HSr1Oe.js";import"./createLucideIcon-D1MVXgdA.js";import"./index-Bi2U6H-I.js";import"./index-Lcj1GtjH.js";import"./index-Ct7uzItS.js";import"./index-XC-7eegb.js";import"./index-DeR6T8Ux.js";import"./index-5RnjzhFd.js";import"./index-CAh_ZuFR.js";import"./index-CKfW5HuH.js";import"./calendar-Blwv3BR4.js";import"./table-BXRjnKkf.js";import"./badge-CBKa4bKq.js";import"./extends-CF3RwP-h.js";import"./index-D1LanMWQ.js";function ts({categories:Q,ewcCodes:k,hpCodes:g,specFields:j}){const[X,D]=m.useState(Q),[d,F]=m.useState({name:"",default_weight:"",ewc_code_id:"",physical_form:"",concentration:"",chemical_component:"",container_type:"",hp_codes:[],spec_fields:[]}),[c,A]=m.useState({name:"",default_weight:"",ewc_code_id:"",physical_form:"",concentration:"",chemical_component:"",container_type:"",hp_codes:[],spec_fields:[]}),[l,E]=m.useState({}),[B,Y]=m.useState(""),[f,_]=m.useState(!1),[Z,q]=m.useState(!1),[ee,P]=m.useState(!1),[T,M]=m.useState(null),W=()=>E({}),o=(s,a="add")=>{const{name:i,value:r}=s.target;a==="add"?F(u=>({...u,[i]:r})):A(u=>({...u,[i]:r}))},v=(s,a,i="add")=>{i==="add"?F(r=>({...r,[s]:a})):A(r=>({...r,[s]:a}))},y=(s,a,i="add")=>{i==="add"?F(r=>({...r,[s]:a})):A(r=>({...r,[s]:a}))},se=async()=>{var s,a;W();try{_(!0);const i=await I.post("/settings/categories",d);i.status===200&&(D(r=>[...r,i.data]),p.success("Category successfully created!"),q(!1))}catch(i){(a=(s=i.response)==null?void 0:s.data)!=null&&a.errors?E(i.response.data.errors):p.error("Failed to create category. Please try again.")}finally{_(!1)}},ae=async()=>{var s,a;if(T){W();try{_(!0);const i=await I.put(`/settings/categories/${T}`,c);if(i.status===200){const r=i.data;D(u=>u.map(O=>O.id===T?r:O)),p.success("Category successfully updated!"),M(null),P(!1)}}catch(i){(a=(s=i.response)==null?void 0:s.data)!=null&&a.errors?E(i.response.data.errors):p.error("Failed to update category. Please try again.")}finally{_(!1)}}},ie=async s=>{try{(await I.delete(`/settings/categories/${s}`)).status===200?(D(i=>i.filter(r=>r.id!==s)),p.success("Category successfully deleted!")):p.error("Failed to delete category. Please try again.")}catch{p.error("Error deleting category. Please check the logs.")}},te=X.filter(s=>s.name.toLowerCase().includes(B.toLowerCase())),re=[...xe,{id:"actions",header:"Actions",cell:({row:s})=>{const a=s.original;return e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(x,{variant:"outline",size:"sm",onClick:()=>window.location.href=`/settings/categories/${a.id}/edit`,children:e.jsx(be,{className:"h-4 w-4"})}),e.jsxs(ue,{children:[e.jsx(ge,{asChild:!0,children:e.jsx(x,{variant:"destructive",size:"sm",children:e.jsx(we,{className:"h-4 w-4"})})}),e.jsxs(je,{children:[e.jsxs(fe,{children:[e.jsx(_e,{children:"Confirm Deletion"}),e.jsxs(ve,{children:["Are you sure you want to delete category ",e.jsx("b",{children:a.name}),"?"]})]}),e.jsxs(ye,{children:[e.jsx(Ce,{children:"Cancel"}),e.jsx(Se,{onClick:()=>ie(a.id),children:"Delete"})]})]})]})]})}}];return e.jsxs(le,{children:[e.jsx(ne,{}),e.jsxs(de,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 bg-white border-b",children:[e.jsx(ce,{className:"-ml-1"}),e.jsx(V,{orientation:"vertical",className:"h-4 mx-2"}),e.jsx(oe,{children:e.jsxs(he,{children:[e.jsx($,{children:e.jsx(L,{href:"/",children:"Dashboard"})}),e.jsx(H,{}),e.jsx($,{children:e.jsx(L,{href:"/settings",children:"Settings"})}),e.jsx(H,{}),e.jsx($,{children:e.jsx(L,{href:"/settings/categories",children:"Categories"})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-8",children:[e.jsx("div",{className:"text-3xl font-semibold text-gray-800",children:"Settings: Categories"}),e.jsxs("section",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"Manage Categories"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, edit, or delete categories used in the system."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(n,{placeholder:"Search Categories...",value:B,onChange:s=>Y(s.target.value),className:"max-w-sm"}),e.jsxs(z,{open:Z,onOpenChange:s=>q(s),children:[e.jsx(pe,{asChild:!0,children:e.jsx(x,{children:"Add Category"})}),e.jsxs(R,{className:"sm:max-w-[800px] bg-white",children:[e.jsxs(U,{children:[e.jsx(G,{children:"Add Category"}),e.jsx(J,{children:"Fill in the required details for the new category."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 py-0",children:[e.jsx("div",{className:"bg-white border rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"name",children:"Category Name*"}),e.jsx(n,{id:"name",name:"name",value:d.name,onChange:s=>o(s,"add"),required:!0}),l.name&&e.jsx("p",{className:"text-red-600 text-sm",children:l.name})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"default_weight",children:"Default Weight*"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(n,{id:"default_weight",name:"default_weight",type:"number",value:d.default_weight,onChange:s=>o(s,"add"),required:!0,className:"pr-10"}),e.jsx("span",{className:"absolute right-3 text-sm text-gray-500",children:"kg"})]}),l.default_weight&&e.jsx("p",{className:"text-red-600 text-sm",children:l.default_weight})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"ewc_code_id",children:"EWC Code*"}),e.jsxs(S,{value:d.ewc_code_id,onValueChange:s=>v("ewc_code_id",s,"add"),required:!0,children:[e.jsx(b,{children:e.jsx(w,{placeholder:"Select EWC Code"})}),e.jsx(N,{children:k.map(s=>e.jsx(h,{value:s.id.toString(),children:s.ewc_code},s.id))})]}),l.ewc_code_id&&e.jsx("p",{className:"text-red-600 text-sm",children:l.ewc_code_id})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"physical_form",children:"Physical Form"}),e.jsxs(S,{value:d.physical_form,onValueChange:s=>v("physical_form",s,"add"),children:[e.jsx(b,{children:e.jsx(w,{placeholder:"Select Physical Form"})}),e.jsxs(N,{children:[e.jsx(h,{value:"Solid",children:"Solid"}),e.jsx(h,{value:"Liquid",children:"Liquid"}),e.jsx(h,{value:"Mixed",children:"Mixed"}),e.jsx(h,{value:"Sludge",children:"Sludge"})]})]})]})]})}),e.jsx("div",{className:"bg-white border rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"concentration",children:"Concentration"}),e.jsx(n,{id:"concentration",name:"concentration",value:d.concentration,onChange:s=>o(s,"add")})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"chemical_component",children:"Chemical Component"}),e.jsx(n,{id:"chemical_component",name:"chemical_component",value:d.chemical_component,onChange:s=>o(s,"add")})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"container_type",children:"Container Type"}),e.jsx(n,{id:"container_type",name:"container_type",value:d.container_type,onChange:s=>o(s,"add")})]}),e.jsx(C,{value:d.hp_codes.map(s=>{const a=g.find(i=>i.id===s);return a?{value:String(a.id),label:`${a.hp_code} - ${a.hp_type}`}:null}).filter(s=>s!==null),options:g.map(s=>({value:String(s.id),label:`${s.hp_code} - ${s.hp_type}`})),onChange:s=>y("hp_codes",s.map(a=>Number(a.value)),"add"),placeholder:"Select HP Codes"}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"spec_fields",children:"Spec Fields"}),e.jsx(C,{value:d.spec_fields.map(s=>{const a=j.find(i=>i.id===s);return a?{value:String(a.id),label:a.spec_name}:null}).filter(s=>s!==null),options:j.map(s=>({value:String(s.id),label:s.spec_name})),onChange:s=>y("spec_fields",s.map(a=>Number(a.value)),"add"),placeholder:"Select Spec Fields"})]})]})})]}),e.jsxs(K,{children:[e.jsx(x,{variant:"outline",onClick:()=>q(!1),children:"Cancel"}),e.jsx(x,{onClick:se,disabled:f,children:f?"Saving...":"Create Category"})]})]})]})]})]}),e.jsx(V,{className:"my-4"}),e.jsx(me,{columns:re,data:te})]}),e.jsx(z,{open:ee,onOpenChange:P,children:e.jsxs(R,{className:"sm:max-w-[600px] bg-white",children:[e.jsxs(U,{children:[e.jsx(G,{children:"Edit Category"}),e.jsx(J,{children:"Update the required details for the category."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"name",children:"Name*"}),e.jsx(n,{id:"name",name:"name",value:c.name,onChange:s=>o(s,"edit"),required:!0}),l.name&&e.jsx("p",{className:"text-red-600 text-sm",children:l.name})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"ewc_code_id",children:"EWC Code*"}),e.jsxs(S,{value:c.ewc_code_id,onValueChange:s=>v("ewc_code_id",s,"edit"),required:!0,children:[e.jsx(b,{children:e.jsx(w,{placeholder:"Select EWC Code"})}),e.jsx(N,{children:k.map(s=>e.jsx(h,{value:s.id.toString(),children:s.ewc_code},s.id))})]}),l.ewc_code_id&&e.jsx("p",{className:"text-red-600 text-sm",children:l.ewc_code_id})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"default_weight",children:"Default Weight*"}),e.jsx(n,{id:"default_weight",name:"default_weight",type:"number",value:c.default_weight,onChange:s=>o(s,"edit"),required:!0}),l.default_weight&&e.jsx("p",{className:"text-red-600 text-sm",children:l.default_weight})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"physical_form",children:"Physical Form"}),e.jsxs(S,{value:c.physical_form,onValueChange:s=>v("physical_form",s,"edit"),children:[e.jsx(b,{children:e.jsx(w,{placeholder:"Select Physical Form"})}),e.jsxs(N,{children:[e.jsx(h,{value:"Solid",children:"Solid"}),e.jsx(h,{value:"Liquid",children:"Liquid"}),e.jsx(h,{value:"Mixed",children:"Mixed"}),e.jsx(h,{value:"Sludge",children:"Sludge"})]})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"concentration",children:"Concentration"}),e.jsx(n,{id:"concentration",name:"concentration",value:c.concentration,onChange:s=>o(s,"edit")})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"chemical_component",children:"Chemical Component"}),e.jsx(n,{id:"chemical_component",name:"chemical_component",value:c.chemical_component,onChange:s=>o(s,"edit")})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"container_type",children:"Container Type"}),e.jsx(n,{id:"container_type",name:"container_type",value:c.container_type,onChange:s=>o(s,"edit")})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"hp_codes",children:"HP Codes"}),e.jsx(C,{value:c.hp_codes.map(s=>{const a=g.find(i=>i.id===s);return a?{value:String(a.id),label:`${a.hp_code} - ${a.hp_type}`}:null}).filter(s=>s!==null),options:g.map(s=>({value:String(s.id),label:`${s.hp_code} - ${s.hp_type}`})),onChange:s=>y("hp_codes",s.map(a=>Number(a.value)),"edit"),placeholder:"Select HP Codes"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"spec_fields",children:"Spec Fields"}),e.jsx(C,{value:c.spec_fields.map(s=>{const a=j.find(i=>i.id===s);return a?{value:String(a.id),label:a.spec_name}:null}).filter(s=>s!==null),options:j.map(s=>({value:String(s.id),label:s.spec_name})),onChange:s=>y("spec_fields",s.map(a=>Number(a.value)),"edit"),placeholder:"Select Spec Fields"})]})]}),e.jsxs(K,{children:[e.jsx(x,{variant:"outline",onClick:()=>{M(null),P(!1)},children:"Cancel"}),e.jsx(x,{onClick:ae,disabled:f,children:f?"Saving...":"Save Changes"})]})]})})]})]})]})}export{ts as default};
