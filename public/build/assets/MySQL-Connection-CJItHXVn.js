import{r as d,j as e,b as p}from"./app-BB65Mc1n.js";import{t as c}from"./index-BD8g9cTJ.js";import{B as m}from"./button-AMd0rht4.js";import{I as l}from"./input-BdsrUm4j.js";import{B as v}from"./badge-BdYjlQZJ.js";import"./index-BD0Aflgb.js";import"./index-CwOflKzf.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";function P(){const[t,o]=d.useState({host:"",port:"",database:"",username:"",password:""}),[a,r]=d.useState(!1),[h,y]=d.useState(!0),[n,u]=d.useState(!1);d.useEffect(()=>{(async()=>{try{const i=await p.get("/settings/connections/mysql");i.data.connected?(r(!0),o({host:i.data.host,port:i.data.port,database:i.data.database,username:i.data.username,password:""})):r(!1)}catch{r(!1)}finally{y(!1)}})()},[]);const f=async()=>{try{(await p.post("/settings/connections/mysql/test",t)).status===200&&c.success("MySQL connection is working!")}catch{c.error("Failed to test MySQL connection. Please check the details and try again.")}},g=async()=>{u(!0);try{(await p.post("/settings/connections/mysql/save",t)).status===200&&(r(!0),c.success("MySQL connection saved successfully!"))}catch{c.error("Failed to save MySQL connection. Please try again.")}finally{u(!1)}},x=async()=>{u(!0);try{(await p.delete("/settings/connections/mysql")).status===200&&(r(!1),o({host:"",port:"",database:"",username:"",password:""}),c.success("Disconnected from MySQL."))}catch{c.error("Failed to disconnect from MySQL.")}finally{u(!1)}},b=h?"success":a?"default":"success";return e.jsxs("div",{className:"bg-white border shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"Aitken MySQL"}),e.jsx(v,{variant:b,children:h?"Loading...":a?"Connected":"Not Connected"})]}),!h&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:a?"Your Aitken MySQL connection is active.":"Enter your Aitken MySQL database details to connect."}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(l,{type:"text",placeholder:"Host",value:t.host,onChange:s=>o({...t,host:s.target.value}),disabled:n||a}),e.jsx(l,{type:"text",placeholder:"Port",value:t.port,onChange:s=>o({...t,port:s.target.value}),disabled:n||a}),e.jsx(l,{type:"text",placeholder:"Database",value:t.database,onChange:s=>o({...t,database:s.target.value}),disabled:n||a}),e.jsx(l,{type:"text",placeholder:"Username",value:t.username,onChange:s=>o({...t,username:s.target.value}),disabled:n||a}),e.jsx(l,{type:"password",placeholder:a?"Password hidden for security":"Password",value:t.password,onChange:s=>o({...t,password:s.target.value}),disabled:n||a}),e.jsxs("div",{className:"flex gap-4",children:[!a&&e.jsx(m,{onClick:g,disabled:n,children:n?"Saving...":"Connect"}),a&&e.jsxs(e.Fragment,{children:[e.jsx(m,{variant:"outline",onClick:f,disabled:n,children:"Test Connection"}),e.jsx(m,{variant:"destructive",onClick:x,disabled:n,children:"Disconnect"})]})]})]})]})]})}export{P as default};
